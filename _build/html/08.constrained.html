

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Constrained optimization &#8212; ECON2125/6012</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '08.constrained';</script>
    <link rel="canonical" href="optim.iskh.me/08.constrained.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Guest lecture" href="09.practical_session.html" />
    <link rel="prev" title="Unconstrained optimization" href="07.unconstrained.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content">Latest update: Lecture 11 (Dynamic optimization), exercise set L, and solutions to exercise set K</div>
  </div>

  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="00.index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/penrose.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/penrose.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00.index.html">
                    ECON2125/6012
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01.introduction.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="02.optimization_intro.html">Univariate and bivariate optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="03.set_theory.html">Elements of set theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="04.basic_analysis.html">Basics of real analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="05.linear_algebra.html">Elements of linear algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="06.optimization_fundamentals.html">Fundamentals of optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="07.unconstrained.html">Unconstrained optimization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Constrained optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="09.practical_session.html">Guest lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="10.envelope_maximum.html">Envelope and maximum theorems</a></li>
<li class="toctree-l1"><a class="reference internal" href="11.dynamic.html">Dynamic optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="12.revision.html">Revision</a></li>
<li class="toctree-l1"><a class="reference internal" href="02.exercises.A.html">Exercise set A</a></li>
<li class="toctree-l1"><a class="reference internal" href="03.exercises.B.html">Exercise set B</a></li>
<li class="toctree-l1"><a class="reference internal" href="04.exercises.C.html">Exercise set C</a></li>
<li class="toctree-l1"><a class="reference internal" href="05.exercises.D.html">Exercise set D</a></li>
<li class="toctree-l1"><a class="reference internal" href="06.exercises.E.html">Exercise set E</a></li>
<li class="toctree-l1"><a class="reference internal" href="07.exercises.F.html">Exercise set F</a></li>
<li class="toctree-l1"><a class="reference internal" href="08.exercises.G.html">Exercise set G</a></li>
<li class="toctree-l1"><a class="reference internal" href="09.exercises.H.html">Exercise set H</a></li>
<li class="toctree-l1"><a class="reference internal" href="10.exercises.K.html">Exercise set K</a></li>
<li class="toctree-l1"><a class="reference internal" href="11.exercises.L.html">Exercise set L</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/fediskhakov/OptimCourse" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/fediskhakov/OptimCourse/issues/new?title=Issue%20on%20page%20%2F08.constrained.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/08.constrained.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Constrained optimization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#announcements-reminders">Announcements &amp; Reminders</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plan-for-this-lecture">Plan for this lecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-a-constrained-optimization-problem">Setting up a constrained optimization problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equality-constrains-and-lagrange-method">Equality constrains and Lagrange method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Constrained Optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#substitution-method">Substitution Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#substitution-method-recipe">Substitution method: recipe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tangency">Tangency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-tangency-relative-slope-conditions">Using Tangency: Relative Slope Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tangency-condition-algorithm">Tangency condition algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slope-conditions-for-minimization">Slope Conditions for Minimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-method-of-lagrange-multipliers">The method of Lagrange multipliers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrangean-as-tangency-condition">Lagrangean as tangency condition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order-conditions">Second order conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrangian-method-recipe">Lagrangian method: recipe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-does-lagrange-method-fail">When does Lagrange method fail?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inequality-constrains-and-kuhn-tucker-method">Inequality constrains and Kuhn-Tucker method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#karush-kuhn-tucker-method-recipe">Karush - Kuhn-Tucker method: recipe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Second order conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-material">Extra material</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="constrained-optimization">
<h1>Constrained optimization<a class="headerlink" href="#constrained-optimization" title="Permalink to this heading">#</a></h1>
<p><strong>ECON2125/6012 Lecture 8</strong>
Fedor Iskhakov</p>
<section id="announcements-reminders">
<h2>Announcements &amp; Reminders<a class="headerlink" href="#announcements-reminders" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Submit Test 3 before <strong>October 4, 23:59</strong></p></li>
<li><p>The test will include the material from the last two lectures (unconstrained and constrained optimization) with some additional material on fundamentals of optimization from the lecture before (properties of optima and convexity)</p></li>
<li><p>Next week you will have a guest lecture by <a class="reference external" href="https://www.linkedin.com/in/esben-scriver-andersen-74159598/?originalSubdomain=au">Dr. Esben Skriver Andersen</a> who is a postdoc at RSE working on structural estimation of dynamic discrete choice and matching models <br />
Topic: numerical methods for practical optimization problems</p></li>
</ul>
<a class="reference internal image-reference" href="_images/esben.jpeg"><img alt="_images/esben.jpeg" src="_images/esben.jpeg" style="width: 224.0px; height: 224.0px;" /></a>
</section>
<section id="plan-for-this-lecture">
<h2>Plan for this lecture<a class="headerlink" href="#plan-for-this-lecture" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Constrained vs unconstrained optimization</p></li>
<li><p>Equality constrains and Lagrange method</p></li>
<li><p>Inequality constrains and Kuhn-Tucker method</p></li>
<li><p>Constrained optimization under convexity</p></li>
</ol>
<p><strong>Supplementary reading:</strong></p>
<ul class="simple">
<li><p>Simon &amp; Blume: 16.2, whole of chapter 18, 19.3</p></li>
<li><p>Sundaram: chapters 5 and 6</p></li>
</ul>
</section>
<section id="setting-up-a-constrained-optimization-problem">
<h2>Setting up a constrained optimization problem<a class="headerlink" href="#setting-up-a-constrained-optimization-problem" title="Permalink to this heading">#</a></h2>
<p>Let’s start with recalling the definition of a general optimization problem</p>
<div class="caution admonition">
<p class="admonition-title">Definition</p>
<p>The general form of the optimization problem is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
V(\theta) 
= \max_{x} f(x,\theta)
\\
\text {subject to}
\\
g_i(x,\theta) = 0, \; i\in\{1,\dots,I\}\\
h_j(x,\theta) \le 0, \; j\in\{1,\dots,J\}
\end{split}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f(x,\theta) \colon \mathbb{R}^N \times \mathbb{R}^K \to \mathbb{R}\)</span> is an objective function</p></li>
<li><p><span class="math notranslate nohighlight">\(x \in \mathbb{R}^N\)</span> are decision/choice variables</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta \in \mathbb{R}^K\)</span> are parameters</p></li>
<li><p><span class="math notranslate nohighlight">\(g_i(x,\theta) = 0, \; i\in\{1,\dots,I\}\)</span> where <span class="math notranslate nohighlight">\(g_i \colon \mathbb{R}^N \times \mathbb{R}^K \to \mathbb{R}\)</span>, are equality constraints</p></li>
<li><p><span class="math notranslate nohighlight">\(h_j(x,\theta) \le 0, \; j\in\{1,\dots,J\}\)</span> where <span class="math notranslate nohighlight">\(h_j \colon \mathbb{R}^N \times \mathbb{R}^K \to \mathbb{R}\)</span>, are inequality constraints</p></li>
<li><p><span class="math notranslate nohighlight">\(V(\theta) \colon \mathbb{R}^K \to \mathbb{R}\)</span> is a value function</p></li>
</ul>
</div>
<p>Today we focus on the problem with constrants, i.e. <span class="math notranslate nohighlight">\(I+J&gt;0\)</span></p>
<p>The obvious classification that we follow</p>
<ul class="simple">
<li><p>equality constrained problems, i.e. <span class="math notranslate nohighlight">\(I&gt;0\)</span>, <span class="math notranslate nohighlight">\(J=0\)</span></p></li>
<li><p>inequality constrained problems, i.e. <span class="math notranslate nohighlight">\(J&gt;0\)</span>, which can include equalities as special case</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that every optimization problem can be seen as <em>constrained</em> if we define the objective function to have the domain that coincides with the admissible set.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\max_x f(x): \mathbb{R}^N \to \mathbb{R}
\\
\text {subject to}
\\
g_i(x) = 0, \; i\in\{1,\dots,I\}\\
h_j(x) \le 0, \; j\in\{1,\dots,J\}
\end{split}\]</div>
<p>is equivalent to</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\max_x f(x): A \to \mathbb{R}
\\
A = \big\{x \in \mathbb{R}^N \colon g_i(x) = 0, \; i\in\{1,\dots,I\} \text{ and } h_j(x) \le 0, \; j\in\{1,\dots,J\}\big\}
\end{split}\]</div>
</div>
</section>
<section id="equality-constrains-and-lagrange-method">
<h2>Equality constrains and Lagrange method<a class="headerlink" href="#equality-constrains-and-lagrange-method" title="Permalink to this heading">#</a></h2>
<section id="id1">
<h3>Constrained Optimization<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>A major focus of econ: the optimal allocation of scarce
resources</p>
<ul class="simple">
<li><p><em>optimal</em> = optimization</p></li>
<li><p><em>scarce</em> = constrained</p></li>
</ul>
<p>Standard constrained problems:</p>
<ul class="simple">
<li><p>Maximize utility given budget</p></li>
<li><p>Maximize portfolio return given risk constraints</p></li>
<li><p>Minimize cost given output requirement</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<p>Maximization of utility subject to budget constraint</p>
<div class="math notranslate nohighlight">
\[ 
%
\max u(x_1, x_2) \; \text{ such that } \; p_1 x_1 + p_2 x_2 \leq m 
%
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p_i\)</span> is the price of good <span class="math notranslate nohighlight">\(i\)</span>, assumed <span class="math notranslate nohighlight">\(&gt; 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> is the budget, assumed <span class="math notranslate nohighlight">\(&gt; 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_i \geq 0\)</span> for <span class="math notranslate nohighlight">\(i = 1,2\)</span></p></li>
<li><p>let <span class="math notranslate nohighlight">\(u(x_1, x_2) = \alpha \log(x_1) + \beta \log(x_2)\)</span>, <span class="math notranslate nohighlight">\(\alpha&gt;0\)</span>, <span class="math notranslate nohighlight">\(\beta&gt;0\)</span></p></li>
</ul>
</div>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/budget_set_1.png"><img alt="_images/budget_set_1.png" src="_images/budget_set_1.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 86 </span><span class="caption-text">Budget set when, <span class="math notranslate nohighlight">\(p_1=1\)</span>, <span class="math notranslate nohighlight">\(p_2 = 1.2\)</span>, <span class="math notranslate nohighlight">\(m=4\)</span></span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="_images/budget_set_2.png"><img alt="_images/budget_set_2.png" src="_images/budget_set_2.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 87 </span><span class="caption-text">Budget set when, <span class="math notranslate nohighlight">\(p_1=0.8\)</span>, <span class="math notranslate nohighlight">\(p_2 = 1.2\)</span>, <span class="math notranslate nohighlight">\(m=4\)</span></span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="_images/log_util.png"><img alt="_images/log_util.png" src="_images/log_util.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 88 </span><span class="caption-text">Log utility with <span class="math notranslate nohighlight">\(\alpha=0.4\)</span>, <span class="math notranslate nohighlight">\(\beta=0.5\)</span></span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id6">
<a class="reference internal image-reference" href="_images/log_util_contour.png"><img alt="_images/log_util_contour.png" src="_images/log_util_contour.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 89 </span><span class="caption-text">Log utility with <span class="math notranslate nohighlight">\(\alpha=0.4\)</span>, <span class="math notranslate nohighlight">\(\beta=0.5\)</span></span><a class="headerlink" href="#id6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>We seek a bundle <span class="math notranslate nohighlight">\((x_1^\star, x_2^\star)\)</span> that maximizes <span class="math notranslate nohighlight">\(u\)</span> over
the budget set</p>
<p>That is,</p>
<div class="math notranslate nohighlight">
\[
%
\alpha \log(x_1^\star) + \beta \log(x_2^\star)
\geq
\alpha \log(x_1) + \beta \log(x_2)
%
\]</div>
<p>for all <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> satisfying <span class="math notranslate nohighlight">\(x_i \geq 0\)</span> for each <span class="math notranslate nohighlight">\(i\)</span> and</p>
<div class="math notranslate nohighlight">
\[
%
p_1 x_1 + p_2 x_2 \leq m
%
\]</div>
<p>Visually, here is the budget set and objective function:</p>
<figure class="align-default" id="id7">
<a class="reference internal image-reference" href="_images/budget_set_3.png"><img alt="_images/budget_set_3.png" src="_images/budget_set_3.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 90 </span><span class="caption-text">Utility max for <span class="math notranslate nohighlight">\(p_1=1\)</span>, <span class="math notranslate nohighlight">\(p_2 = 1.2\)</span>, <span class="math notranslate nohighlight">\(m=4\)</span>, <span class="math notranslate nohighlight">\(\alpha=0.4\)</span>,
<span class="math notranslate nohighlight">\(\beta=0.5\)</span></span><a class="headerlink" href="#id7" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>First observation: <span class="math notranslate nohighlight">\(u(0, x_2) = u(x_1, 0) = u(0, 0) = -\infty\)</span></p>
<ul class="simple">
<li><p>Hence we need consider only strictly positive bundles</p></li>
</ul>
<p>Second observation: <span class="math notranslate nohighlight">\(u(x_1, x_2)\)</span> is
strictly increasing in both <span class="math notranslate nohighlight">\(x_i\)</span></p>
<ul class="simple">
<li><p>Never choose a point <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> with <span class="math notranslate nohighlight">\(p_1 x_1 + p_2 x_2 &lt; m\)</span></p></li>
<li><p>Otherwise can increase <span class="math notranslate nohighlight">\(u(x_1, x_2)\)</span> by small change</p></li>
</ul>
<p>Hence we can replace <span class="math notranslate nohighlight">\(\leq\)</span> with <span class="math notranslate nohighlight">\(=\)</span> in the constraint</p>
<div class="math notranslate nohighlight">
\[
%
p_1 x_1 + p_2 x_2 \leq m
\quad \text{becomes} \quad
p_1 x_1 + p_2 x_2 = m
%
\]</div>
<p>Implication: Just search along the budget line</p>
</section>
<section id="substitution-method">
<h3>Substitution Method<a class="headerlink" href="#substitution-method" title="Permalink to this heading">#</a></h3>
<p>Substitute constraint into objective function</p>
<p>This changes</p>
<div class="math notranslate nohighlight">
\[ 
%
\max_{x_1, x_2} \left\{ \alpha \log(x_1) + \beta \log(x_2) \right\}
\text{ such that } \; p_1 x_1 + p_2 x_2 = m 
%
\]</div>
<p>into</p>
<div class="math notranslate nohighlight">
\[ 
%
\max_{x_1} \left\{ \alpha \log(x_1) + \beta \log((m - p_1x_1) / p_2) \right\}
%
\]</div>
<p>Since all candidates satisfy <span class="math notranslate nohighlight">\(x_1 &gt; 0\)</span> and <span class="math notranslate nohighlight">\(x_2 &gt; 0\)</span>, the domain is</p>
<div class="math notranslate nohighlight">
\[ 0 &lt; x_1 &lt; \frac{m}{p_1} \]</div>
<figure class="align-default" id="id8">
<a class="reference internal image-reference" href="_images/one_dim_budget.png"><img alt="_images/one_dim_budget.png" src="_images/one_dim_budget.png" style="width: 620.0px; height: 382.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 91 </span><span class="caption-text">Utility max for <span class="math notranslate nohighlight">\(p_1=1\)</span>, <span class="math notranslate nohighlight">\(p_2 = 1.2\)</span>, <span class="math notranslate nohighlight">\(m=4\)</span>, <span class="math notranslate nohighlight">\(\alpha=0.4\)</span>,
<span class="math notranslate nohighlight">\(\beta=0.5\)</span></span><a class="headerlink" href="#id8" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id9">
<a class="reference internal image-reference" href="_images/log_util_budget_line.png"><img alt="_images/log_util_budget_line.png" src="_images/log_util_budget_line.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 92 </span><span class="caption-text">Utility max for <span class="math notranslate nohighlight">\(p_1=1\)</span>, <span class="math notranslate nohighlight">\(p_2 = 1.2\)</span>, <span class="math notranslate nohighlight">\(m=4\)</span>, <span class="math notranslate nohighlight">\(\alpha=0.4\)</span>,
<span class="math notranslate nohighlight">\(\beta=0.5\)</span></span><a class="headerlink" href="#id9" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>First order condition for</p>
<div class="math notranslate nohighlight">
\[ 
%
\max_{x_1} \left\{ \alpha \log(x_1) + \beta \log((m - p_1x_1) / p_2) \right\}
%
\]</div>
<p>gives</p>
<div class="math notranslate nohighlight">
\[
%
x_1^\star = \frac{\alpha}{\alpha + \beta} \cdot \frac{m}{p_1}
%
\]</div>
<p><strong>Exercise:</strong> Verify</p>
<p><strong>Exercise:</strong> Check second order condition (strict concavity)</p>
<p>Substituting into <span class="math notranslate nohighlight">\(p_1 x_1^\star + p_2 x_2^\star = m\)</span> gives</p>
<div class="math notranslate nohighlight">
\[
%
x_2^\star = \frac{\beta}{\beta + \alpha} \cdot \frac{m}{p_2}
%
\]</div>
<figure class="align-default" id="id10">
<a class="reference internal image-reference" href="_images/log_util_optimizer.png"><img alt="_images/log_util_optimizer.png" src="_images/log_util_optimizer.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 93 </span><span class="caption-text">Maximizer for <span class="math notranslate nohighlight">\(p_1=1\)</span>, <span class="math notranslate nohighlight">\(p_2 = 1.2\)</span>, <span class="math notranslate nohighlight">\(m=4\)</span>, <span class="math notranslate nohighlight">\(\alpha=0.4\)</span>,
<span class="math notranslate nohighlight">\(\beta=0.5\)</span></span><a class="headerlink" href="#id10" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="substitution-method-recipe">
<h3>Substitution method: recipe<a class="headerlink" href="#substitution-method-recipe" title="Permalink to this heading">#</a></h3>
<p>How to solve</p>
<div class="math notranslate nohighlight">
\[\begin{split}
%
\max_{x_1, x_2} \; f(x_1, x_2) 
\\
\text{ such that } g(x_1, x_2) = 0
%
\end{split}\]</div>
<p>Steps:</p>
<ol class="arabic simple">
<li><p>Write constraint as <span class="math notranslate nohighlight">\(x_2 = h(x_1)\)</span> for some function <span class="math notranslate nohighlight">\(h\)</span></p></li>
</ol>
<ul class="simple">
<li><p>Solve univariate problem <span class="math notranslate nohighlight">\(\max_{x_1} f(x_1, h(x_1))\)</span> to get <span class="math notranslate nohighlight">\(x_1^\star\)</span></p></li>
</ul>
<ol class="arabic simple" start="9">
<li><p>Plug <span class="math notranslate nohighlight">\(x_1^\star\)</span> into <span class="math notranslate nohighlight">\(x_2 = h(x_1)\)</span> to get <span class="math notranslate nohighlight">\(x_2^\star\)</span></p></li>
</ol>
<p><strong>Limitations</strong>: substitution doesn’t always work</p>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<p>Suppose that <span class="math notranslate nohighlight">\(g(x_1, x_2) = x_1^2 + x_2^2 - 1\)</span></p>
<p>Step 1 from the cookbook says</p>
<p>use <span class="math notranslate nohighlight">\(g(x_1, x_2) = 0\)</span> to write <span class="math notranslate nohighlight">\(x_2\)</span> as a function of <span class="math notranslate nohighlight">\(x_1\)</span></p>
<p>But <span class="math notranslate nohighlight">\(x_2\)</span> has two possible values for each <span class="math notranslate nohighlight">\(x_1 \in (-1, 1)\)</span></p>
<div class="math notranslate nohighlight">
\[
%
x_2 = \pm \sqrt{1 - x_1^2}
%
\]</div>
<p>In other words, <span class="math notranslate nohighlight">\(x_2\)</span> is not a well defined function of <span class="math notranslate nohighlight">\(x_1\)</span></p>
</div>
<p>As we meet more complicated constraints such problems intensify</p>
<ul class="simple">
<li><p>Constraint defines complex curve in <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> space</p></li>
<li><p>Inequality constraints, etc.</p></li>
</ul>
<p>We need more general, systematic approach</p>
</section>
<section id="tangency">
<h3>Tangency<a class="headerlink" href="#tangency" title="Permalink to this heading">#</a></h3>
<p>Consider again the problem</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\max_{x_1, x_2} \left\{ \alpha \log(x_1) + \beta \log(x_2) \right\}
\\ 
\text{ such that } p_1 x_1 + p_2 x_2 = m
\end{split}\]</div>
<p>Turns out that the maximizer has the following property:</p>
<ul class="simple">
<li><p>budget line is tangent to an indifference curve at maximizer</p></li>
</ul>
<figure class="align-default" id="id11">
<a class="reference internal image-reference" href="_images/log_util_maximizer_tangent.png"><img alt="_images/log_util_maximizer_tangent.png" src="_images/log_util_maximizer_tangent.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 94 </span><span class="caption-text">Maximizer for <span class="math notranslate nohighlight">\(p_1=1\)</span>, <span class="math notranslate nohighlight">\(p_2 = 1.2\)</span>, <span class="math notranslate nohighlight">\(m=4\)</span>, <span class="math notranslate nohighlight">\(\alpha=0.4\)</span>,
<span class="math notranslate nohighlight">\(\beta=0.5\)</span></span><a class="headerlink" href="#id11" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In fact this is an instance of a general pattern</p>
<p>Notation: Let’s call <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> interior to the budget line if <span class="math notranslate nohighlight">\(x_i &gt; 0\)</span> for
<span class="math notranslate nohighlight">\(i=1,2\)</span> (not a “corner” solution, see below)</p>
<p>In general, any interior maximizer <span class="math notranslate nohighlight">\((x_1^\star, x_2^\star)\)</span> of differentiable utility function <span class="math notranslate nohighlight">\(u\)</span> has the property: budget line is tangent to a contour line at <span class="math notranslate nohighlight">\((x_1^\star, x_2^\star)\)</span></p>
<p>Otherwise we can do better:</p>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="_images/log_util_not_maximizer.png"><img alt="_images/log_util_not_maximizer.png" src="_images/log_util_not_maximizer.png" style="width: 600.0px; height: 450.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 95 </span><span class="caption-text">When tangency fails we can do better</span><a class="headerlink" href="#id12" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Necessity of tangency often rules out a lot of points. We exploit this fact to</p>
<ul class="simple">
<li><p>Build intuition</p></li>
<li><p>Develop more general methods</p></li>
</ul>
<div class="admonition-diversion-derivative-of-an-implicit-function admonition">
<p class="admonition-title">Diversion: derivative of an implicit function</p>
<p>To continue with the tangency approach we need to know how to differentiate an implicit function <span class="math notranslate nohighlight">\(x_2(x_1)\)</span> which is given by a contour line of the utility function <span class="math notranslate nohighlight">\(u(x_1, x_2)=c\)</span></p>
<p>Let’s approach this task in the following way</p>
<ul class="simple">
<li><p>utility function is given by <span class="math notranslate nohighlight">\(u \colon \mathbb{R}^2 \to \mathbb{R}\)</span></p></li>
<li><p>the contour line is given by <span class="math notranslate nohighlight">\(f(x_1,x_2) = c\)</span> which defines an <em><strong>implicit function</strong></em> <span class="math notranslate nohighlight">\(x_1(x_2)\)</span></p></li>
<li><p>let map <span class="math notranslate nohighlight">\(g \colon \mathbb{R} \to \mathbb{R}^2\)</span> given by <span class="math notranslate nohighlight">\(g(x_2) = \big[x_1(x_2),x_2\big]\)</span></p></li>
</ul>
<p>The total derivative of <span class="math notranslate nohighlight">\(f \circ g\)</span> can be derived using the chain rule</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Dg(x_2) = 
\left(
\begin{array}{c}
\frac{d x_1}{d x_2} \\
1
\end{array}
\right)
\\
Df({\bf x}) = 
\left(
\frac{\partial f}{\partial x_1}({\bf x}),
\frac{\partial f}{\partial x_2}({\bf x})
\right) =
\big(f_1({\bf x}),f_2({\bf x})\big)
\\
D(f \circ g)({\bf x}) = Df({\bf x}) \cdot Dg({\bf x}) = 
f_1\big(g(x_2)\big) \frac{d x_1}{d x_2} + 
f_2\big(g(x_2)\big)
\end{split}\]</div>
<p>Differentiating the equation <span class="math notranslate nohighlight">\(f(x_1,x_2) = c\)</span> on both sides with respect to <span class="math notranslate nohighlight">\(x_2\)</span> gives <span class="math notranslate nohighlight">\(D(f \circ g)({\bf x}) = 0\)</span>, thus leading to the final expression for the derivative of the implicit function</p>
<div class="math notranslate nohighlight">
\[
\frac{d x_1}{d x_2}(x_2) = 
- \frac{f_2(x_1,x_2)}{f_1(x_1,x_2)} =
- \frac{f_2(x_1,x_2)}{f_1(x_1,x_2)}
\]</div>
</div>
</section>
<section id="using-tangency-relative-slope-conditions">
<h3>Using Tangency: Relative Slope Conditions<a class="headerlink" href="#using-tangency-relative-slope-conditions" title="Permalink to this heading">#</a></h3>
<p>Consider an equality constrained optimization problem where objective and constraint functions are differentiable:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
%
f(x_1, x_2) \longrightarrow \max_{x_1, x_2}
\\
\text{ such that } g(x_1, x_2) = 0
%
\end{split}\]</div>
<p>How to develop necessary conditions for optima via tangency?</p>
<figure class="align-default" id="id13">
<a class="reference internal image-reference" href="_images/tangency_1.png"><img alt="_images/tangency_1.png" src="_images/tangency_1.png" style="width: 747.0px; height: 510.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 96 </span><span class="caption-text">Contours for <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span></span><a class="headerlink" href="#id13" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id14">
<a class="reference internal image-reference" href="_images/tangency_2.png"><img alt="_images/tangency_2.png" src="_images/tangency_2.png" style="width: 747.0px; height: 510.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 97 </span><span class="caption-text">Contours for <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span></span><a class="headerlink" href="#id14" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id15">
<a class="reference internal image-reference" href="_images/tangency_3.png"><img alt="_images/tangency_3.png" src="_images/tangency_3.png" style="width: 747.0px; height: 510.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 98 </span><span class="caption-text">Tangency necessary for optimality</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>How do we locate an optimal <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> pair?</p>
<figure class="align-default" id="id16">
<a class="reference internal image-reference" href="_images/tangency_4.png"><img alt="_images/tangency_4.png" src="_images/tangency_4.png" style="width: 747.0px; height: 510.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 99 </span><span class="caption-text">Slope of contour lines</span><a class="headerlink" href="#id16" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Let’s choose <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> to equalize the slopes</p>
<p>That is, choose <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> to solve</p>
<div class="math notranslate nohighlight">
\[
%
- \frac{f_1(x_1, x_2)} {f_2(x_1, x_2)}
= 
- \frac{g_1(x_1, x_2)} {g_2(x_1, x_2)}
%
\]</div>
<p>Equivalent:</p>
<div class="math notranslate nohighlight">
\[
%
\frac{f_1(x_1, x_2)} {f_2(x_1, x_2)}
= 
\frac{g_1(x_1, x_2)} {g_2(x_1, x_2)}
%
\]</div>
<p>Also need to respect <span class="math notranslate nohighlight">\(g(x_1, x_2) = 0\)</span></p>
<figure class="align-default" id="id17">
<a class="reference internal image-reference" href="_images/tangency_5.png"><img alt="_images/tangency_5.png" src="_images/tangency_5.png" style="width: 747.0px; height: 510.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 100 </span><span class="caption-text">Condition for tangency</span><a class="headerlink" href="#id17" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="tangency-condition-algorithm">
<h3>Tangency condition algorithm<a class="headerlink" href="#tangency-condition-algorithm" title="Permalink to this heading">#</a></h3>
<p>In summary, when <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> are both differentiable functions,
to find candidates for optima in</p>
<div class="math notranslate nohighlight">
\[
%
\max_{x_1, x_2} f(x_1, x_2) 
%
\]</div>
<div class="math notranslate nohighlight">
\[
%
\text{ such that } \; g(x_1, x_2) = 0
%
\]</div>
<ol class="arabic simple">
<li><p>(Impose slope tangency) Set</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
%
\frac{f_1(x_1, x_2)}{f_2(x_1, x_2)}
= \frac{g_1(x_1, x_2)}{g_2(x_1, x_2)}
%
\]</div>
<ol class="arabic simple" start="2">
<li><p>(Impose constraint) Set <span class="math notranslate nohighlight">\(g(x_1, x_2) = 0\)</span></p></li>
<li><p>Solve simultaneously for <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> pairs satisfying these conditions</p></li>
</ol>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<p>Consider again</p>
<div class="math notranslate nohighlight">
\[ 
%
\max_{x_1, x_2} \left\{ \alpha \log(x_1) + \beta \log(x_2) \right\}
%
\]</div>
<div class="math notranslate nohighlight">
\[
%
\text{ such that } \; p_1 x_1 + p_2 x_2 - m = 0
%
\]</div>
<p>Then</p>
<div class="math notranslate nohighlight">
\[
%
\frac{f_1(x_1, x_2)}{f_2(x_1, x_2)}
= \frac{g_1(x_1, x_2)}{g_2(x_1, x_2)}
\quad \iff \quad
\frac{\alpha}{\beta} \frac{x_2}{x_1}
= \frac{p_1}{p_2}
%
\]</div>
<p>Solving simultaneously with <span class="math notranslate nohighlight">\(p_1 x_1 + p_2 x_2 = m\)</span> gives</p>
<div class="math notranslate nohighlight">
\[
%
x_1^\star = \frac{\alpha}{\alpha + \beta} \cdot \frac{m}{p_1}
\quad \text{and} \quad
x_2^\star = \frac{\beta}{\beta + \alpha} \cdot \frac{m}{p_2}
%
\]</div>
<p>Same as before…</p>
</div>
</section>
<section id="slope-conditions-for-minimization">
<h3>Slope Conditions for Minimization<a class="headerlink" href="#slope-conditions-for-minimization" title="Permalink to this heading">#</a></h3>
<p>Good news: The conditions are exactly the same</p>
<p>In particular:</p>
<ul class="simple">
<li><p>Lack of tangency means not optimizer</p></li>
<li><p>Constraint must be satisfied</p></li>
</ul>
<figure class="align-default" id="id18">
<a class="reference internal image-reference" href="_images/tangency_min_1.png"><img alt="_images/tangency_min_1.png" src="_images/tangency_min_1.png" style="width: 718.0px; height: 452.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 101 </span><span class="caption-text">Lack of tangency</span><a class="headerlink" href="#id18" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id19">
<a class="reference internal image-reference" href="_images/tangency_min_2.png"><img alt="_images/tangency_min_2.png" src="_images/tangency_min_2.png" style="width: 747.0px; height: 510.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 102 </span><span class="caption-text">Condition for tangency</span><a class="headerlink" href="#id19" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="the-method-of-lagrange-multipliers">
<h3>The method of Lagrange multipliers<a class="headerlink" href="#the-method-of-lagrange-multipliers" title="Permalink to this heading">#</a></h3>
<div class="important admonition">
<p class="admonition-title">Lagrange theorem</p>
<p>Let <span class="math notranslate nohighlight">\(f \colon \mathbb{R}^N \to \mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(g \colon \mathbb{R}^N \to \mathbb{R}^K\)</span> be continuously differentiable functions.</p>
<p>Let <span class="math notranslate nohighlight">\(D = U \cap \{ {\bf x} \colon g_i({\bf x}) = 0, i=1,\dots,K \}\)</span> where <span class="math notranslate nohighlight">\(U \subset \mathbb{R}^N\)</span> is an open set.</p>
<p>Suppose that <span class="math notranslate nohighlight">\({\bf x}^\star \in D\)</span> is a local extremum of <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\(D\)</span> and that the gradients of the constraint functions <span class="math notranslate nohighlight">\(g_i\)</span> are linearly independent at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span> (equivalently, the rank of the Jacobian matrix <span class="math notranslate nohighlight">\(Dg({\bf x}^\star)\)</span> is equal to <span class="math notranslate nohighlight">\(K\)</span>)</p>
<p>Then there exists a vector <span class="math notranslate nohighlight">\(\lambda^\star \in \mathbb{R}^K\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
Df({\bf x}^\star) - \lambda^\star \cdot Dg({\bf x}^\star) =
Df({\bf x}^\star) - \sum_{i=1}^K \lambda_i^\star Dg_i({\bf x}^\star) =
{\bf 0}
\]</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Proof</p>
<p>See Sundaram 5.6, 5.7</p>
</div>
<div class="caution admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda^\star\)</span> is called the vector of <strong>Lagrange multipliers</strong></p></li>
<li><p>The assumption that the gradients of the constraint functions <span class="math notranslate nohighlight">\(g_i\)</span> are linearly independent at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span> is called the <strong>constraint qualification</strong> assumption</p></li>
<li><p>Lagrange theorem provides <em><strong>necessary</strong></em> first order conditions for both maximum and minimum problems</p></li>
</ul>
</div>
<div class="caution admonition">
<p class="admonition-title">Definition</p>
<p>The function <span class="math notranslate nohighlight">\(\mathcal{L} \colon \mathbb{R}^{N+K} \to \mathbb{R}\)</span> defined as</p>
<div class="math notranslate nohighlight">
\[
\mathcal{L}({\bf x},{\bf \lambda}) 
= f({\bf x}) - \lambda \cdot g({\bf x}) =
f({\bf x}) - \sum_{i=1}^K \lambda_i g_i({\bf x})
\]</div>
<p>is called a <strong>Lagrangian</strong> (function)</p>
</div>
<ul class="simple">
<li><p>Different sources define the Lagrangian with <em>minus or plus</em> in front of the second term: mathematically the two definitions are equivalent, but the choice of the sign affects the interpretation of the Lagrange multipliers</p></li>
<li><p>I like to have a minus in the Lagrangian for consistency with the inequality constrained case where the sign is important</p></li>
<li><p>We come back to this in lecture 10</p></li>
</ul>
<div class="important admonition">
<p class="admonition-title">Fact</p>
<p>First order conditions for the Lagrangian coincide with the conditions in the Lagrange theorem, and together with the constraint qualification assumption they provide <em>necessary</em> first order conditions for the constrained optimization problem.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\max_{x_1, x_2} \left\{ \alpha \log(x_1) + \beta \log(x_2) \right\} \\
\text{ such that } \; p_1 x_1 + p_2 x_2 - m = 0
\end{split}\]</div>
<p>Form the Lagrangian</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{L}(x_1,x_2,\lambda) = \alpha \log(x_1) + \beta \log(x_2)
- \lambda(p_1 x_1 + p_2 x_2 - m)
\]</div>
<p>FOC</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{\partial \mathcal{L}}{\partial x_1} = 0 \implies
\frac{\alpha}{x_1} - \lambda p_1 = 0\\
\frac{\partial \mathcal{L}}{\partial x_2} = 0 \implies
\frac{\beta}{x_2} - \lambda p_2 = 0 \\
\frac{\partial \mathcal{L}}{\partial \lambda} = 0 \implies
x_1 p_1 + x_2 p_2 -m = 0
\end{split}\]</div>
<p>From the first two equations we have <span class="math notranslate nohighlight">\(x_1 = \frac{\alpha}{\lambda p_1}\)</span> and <span class="math notranslate nohighlight">\(x_2 = \frac{\beta}{\lambda p_2}\)</span>, and then from the third one <span class="math notranslate nohighlight">\(\frac{\alpha}{\lambda} + \frac{\beta}{\lambda} = m\)</span>.
This gives <span class="math notranslate nohighlight">\(\lambda = \frac{\alpha + \beta}{m}\)</span>, leading to the same result</p>
<div class="math notranslate nohighlight">
\[
%
x_1^\star = \frac{\alpha}{\alpha + \beta} \cdot \frac{m}{p_1}
\quad \text{and} \quad
x_2^\star = \frac{\beta}{\beta + \alpha} \cdot \frac{m}{p_2}
%
\]</div>
</div>
</section>
<section id="lagrangean-as-tangency-condition">
<h3>Lagrangean as tangency condition<a class="headerlink" href="#lagrangean-as-tangency-condition" title="Permalink to this heading">#</a></h3>
<p>The “standard machine” for optimization with equality constraints</p>
<div class="math notranslate nohighlight">
\[
%
\max_{x_1, x_2} f(x_1, x_2) 
\; \text{ such that } \;
g(x_1, x_2) = 0
%
\]</div>
<p>Set</p>
<div class="math notranslate nohighlight">
\[
%
\mathcal{L}(x_1, x_2, \lambda) := f(x_1, x_2) - \lambda g(x_1, x_2)
%
\]</div>
<p>and solve the system of</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \mathcal{L}}{\partial x_1} = 0,
\quad
\frac{\partial \mathcal{L}}{\partial x_2} = 0,
\quad
\frac{\partial \mathcal{L}}{\partial \lambda} = 0
\]</div>
<p>We have</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \mathcal{L}}{\partial x_i}(x_1, x_2, \lambda) = 0
\iff 
f_i(x_1, x_2) = - \lambda g_i(x_1, x_2), \; i=1,2
\]</div>
<p>Hence <span class="math notranslate nohighlight">\(\frac{\partial \mathcal{L}}{\partial x_1} = \frac{\partial \mathcal{L}}{\partial x_2} = 0\)</span> gives</p>
<div class="math notranslate nohighlight">
\[
%
\frac{f_1(x_1, x_2)}{f_2(x_1, x_2)}
= \frac{g_1(x_1, x_2)}{g_2(x_1, x_2)}
%
\]</div>
<p>Finally</p>
<div class="math notranslate nohighlight">
\[
%
\frac{\partial \mathcal{L}}{\partial \lambda}(x_1, x_2, \lambda) = 0
\iff
g(x_1, x_2) = 0
%
\]</div>
<p>Hence the method leads us to the same conditions as the tangency condition method!</p>
</section>
<section id="second-order-conditions">
<h3>Second order conditions<a class="headerlink" href="#second-order-conditions" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>similar to the unconstrained case, but applied to the Lagrangian</p></li>
<li><p>have to do with <strong>local optima</strong> only</p></li>
<li><p>similarly, provide sufficient conditions in the strict case, but only necessary conditions in the weak case</p></li>
</ul>
<p>Using the rules of the differentiation from multivariate calculus we can express
the gradient and the Hessian of the Lagrangian w.r.t. <span class="math notranslate nohighlight">\({\bf x}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla_{\bf x} \mathcal{L}({\bf \lambda},{\bf x}) =
Df({\bf x}) - \lambda \cdot Dg({\bf x})\\
H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x}) =
Hf({\bf x}) - \lambda \cdot Hg({\bf x})
\end{split}\]</div>
<div class="important admonition">
<p class="admonition-title">Fact (necessary SOC)</p>
<p>Let <span class="math notranslate nohighlight">\(f \colon \mathbb{R}^N \to \mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(g \colon \mathbb{R}^N \to \mathbb{R}^K\)</span> be twice continuously differentiable functions (<span class="math notranslate nohighlight">\(C^2\)</span>) and
let <span class="math notranslate nohighlight">\(D = U \cap \{ {\bf x} \colon g_i({\bf x}) = 0, i=1,\dots,K \}\)</span> where <span class="math notranslate nohighlight">\(U \subset \mathbb{R}^N\)</span> is an open set.</p>
<p>Suppose <span class="math notranslate nohighlight">\({\bf x}^\star \in D\)</span> is the local constrained optimizer of <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\(D\)</span> and that the constraint qualification assumption holds at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span>.</p>
<p>Then:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(f\)</span> has a <strong>local maximum</strong> on <span class="math notranslate nohighlight">\(D\)</span> at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span>, then <span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> defined above is <strong>negative semi-definite</strong> on a linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span>, that is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\forall v \in \mathbb{R}^N \text{ and } Dg({\bf x}^\star)\cdot v = {\bf 0} \implies
v' H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x}) v \le 0
\]</div>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(f\)</span> has a <strong>local minimum</strong> on <span class="math notranslate nohighlight">\(D\)</span> at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span>, then <span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> defined above is <strong>positive semi-definite</strong> on a linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span>, that is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\forall v \in \mathbb{R}^N \text{ and } Dg({\bf x}^\star)\cdot v = {\bf 0} \implies
v' H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x}) v \ge 0
\]</div>
</div>
<div class="important admonition">
<p class="admonition-title">Fact (sufficient SOC)</p>
<p>Let <span class="math notranslate nohighlight">\(f \colon \mathbb{R}^N \to \mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(g \colon \mathbb{R}^N \to \mathbb{R}^K\)</span> be twice continuously differentiable functions (<span class="math notranslate nohighlight">\(C^2\)</span>) and
let <span class="math notranslate nohighlight">\(D = U \cap \{ {\bf x} \colon g_i({\bf x}) = 0, i=1,\dots,K \}\)</span> where <span class="math notranslate nohighlight">\(U \subset \mathbb{R}^N\)</span> is an open set.</p>
<p>Suppose there exists <span class="math notranslate nohighlight">\({\bf x}^\star \in D\)</span> such that <span class="math notranslate nohighlight">\(\mathrm{rank}(Dg({\bf x}^\star)) = K\)</span> and <span class="math notranslate nohighlight">\(Df({\bf x}^\star) - \lambda^\star \cdot Dg({\bf x}^\star) = {\bf 0}\)</span> for some <span class="math notranslate nohighlight">\(\lambda^\star \in \mathbb{R}^K\)</span> and the constraint qualification assumption holds at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span> (FOC satisfied)</p>
<p>Then:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> defined above is <strong>negative definite</strong> on a linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span>, that is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\forall v \ne {\bf 0} \text{ and } Dg({\bf x}^\star)\cdot v = {\bf 0} \implies
v' H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x}) v &lt; 0,
\]</div>
<p>then <span class="math notranslate nohighlight">\({\bf x}^\star\)</span> is the <strong>local constrained maximum</strong> of <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\(D\)</span></p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> defined above is <strong>positive definite</strong> on a linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span>, that is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\forall v \ne {\bf 0} \text{ and } Dg({\bf x}^\star)\cdot v = {\bf 0} \implies
v' H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x}) v &gt; 0
\]</div>
<p>then <span class="math notranslate nohighlight">\({\bf x}^\star\)</span> is the <strong>local constrained minimum</strong> of <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\(D\)</span></p>
</div>
<p>Thus, the structure of both the necessary and the sufficient conditions is very similar to the unconstrained case.</p>
<p>The important difference is that the definiteness of the Hessian is checked on the linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span> rather than on the whole <span class="math notranslate nohighlight">\(\mathbb{R}^N\)</span>.</p>
<p>The linear constraint set represents the tangent hyperplane to the constraint set at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span>.</p>
<p><em>But how do we check for definiteness on a linear constraint set?</em></p>
<div class="caution admonition">
<p class="admonition-title">Definition</p>
<p>The Hessian of the Lagrangian with respect to <span class="math notranslate nohighlight">\((\lambda, {\bf x})\)</span> is caleld a <strong>bordered Hessian</strong>, and is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
H \mathcal{L}({\bf \lambda},{\bf x}) =
\left(
\begin{array}{ll}
[{\bf 0}]_{K \times K} &amp;
[-Dg({\bf x})]_{K \times N} \\
[-Dg({\bf x})]'_{N \times K} &amp;
[Hf({\bf x}) - \lambda \cdot Hg({\bf x})]_{N \times N}
\end{array}
\right)
\end{split}\]</div>
</div>
<p>Similarly to the Hessian w.r.t. <span class="math notranslate nohighlight">\({\bf x}\)</span> above, we can derive the bordered Hessian using the rules of the differentiation from multivariate calculus, differentiating the gradient of the Lagrangian w.r.t. <span class="math notranslate nohighlight">\((\lambda,{\bf x})\)</span> which is given</p>
<div class="math notranslate nohighlight">
\[
\nabla \mathcal{L}({\bf \lambda},{\bf x}) =
\big(-g({\bf x}) \;, \; Df({\bf x}) - \lambda \cdot Dg({\bf x})\big)
\]</div>
<ul class="simple">
<li><p>The subscripts in the definition above denote the shape of the blocks in the bordered Hessian</p></li>
<li><p>Some textbooks place the “boarder”, i.e. Jacobians of the constrained in upper left corner and the Hessian w.r.t. <span class="math notranslate nohighlight">\({\bf x}\)</span> of the objective in the lower right corner, with corresponding changes in the propositions below</p></li>
<li><p>the sign for the second term in the Lagrangian also appears and may differ between different texts</p></li>
</ul>
<div class="caution admonition">
<p class="admonition-title">Definition</p>
<p>Consider a <span class="math notranslate nohighlight">\(n \times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> and let <span class="math notranslate nohighlight">\(0 &lt; k \le n\)</span>.</p>
<p>The <strong>leading principal minor</strong> of order <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(A\)</span> is the determinant of a matrix obtained from <span class="math notranslate nohighlight">\(A\)</span> by deleting its last <span class="math notranslate nohighlight">\(n-k\)</span> rows and columns.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = 
\left(
\begin{array}{ccc}
a_{11} &amp; \cdots &amp; a_{1n} \\
\vdots &amp; \ddots &amp; \vdots \\
a_{n1} &amp; \cdots &amp; a_{nn}
\end{array}
\right)
\end{split}\]</div>
<p>The leading principal minors of oder <span class="math notranslate nohighlight">\(k = 1,\dots,n\)</span> of <span class="math notranslate nohighlight">\(A\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
M_1 = \mathrm{det}(a_{11}) = a_{11} \\
M_2 = \mathrm{det}\left(
\begin{array}{cc}
a_{11} &amp; a_{12} \\
a_{21} &amp; a_{22}
\end{array}
\right)
= a_{11}a_{22} - a_{12}a_{21} \\
M_3 = \mathrm{det}\left(
\begin{array}{ccc}
a_{11} &amp; a_{12} &amp; a_{13} \\
a_{21} &amp; a_{22} &amp; a_{23} \\
a_{31} &amp; a_{32} &amp; a_{33}
\end{array}
\right)\\
\vdots \\
M_n = \mathrm{det}(A)
\end{array}
\end{split}\]</div>
</div>
<div class="important admonition">
<p class="admonition-title">Fact</p>
<p>In the same settings as propositions above, namely for <span class="math notranslate nohighlight">\(f \colon \mathbb{R}^N \to \mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(g \colon \mathbb{R}^N \to \mathbb{R}^K\)</span> twice continuously differentiable functions (<span class="math notranslate nohighlight">\(C^2\)</span>) and
<span class="math notranslate nohighlight">\(D = U \cap \{ {\bf x} \colon g_i({\bf x}) = 0, i=1,\dots,K \}\)</span> where <span class="math notranslate nohighlight">\(U \subset \mathbb{R}^N\)</span> is an open.</p>
<p><span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> is <strong>negative semi-definite</strong> on a linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span>
<span class="math notranslate nohighlight">\(\iff\)</span>
the last <span class="math notranslate nohighlight">\(N-K\)</span> leading principal minors of <span class="math notranslate nohighlight">\(H \mathcal{L}({\bf \lambda},{\bf x})\)</span> are zero or alternate in sign, with the sign of the full Hessian matrix equal to <span class="math notranslate nohighlight">\((-1)^N\)</span>.</p>
<p><span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> is <strong>positive semi-definite</strong> on a linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span>
<span class="math notranslate nohighlight">\(\iff\)</span>
the last <span class="math notranslate nohighlight">\(N-K\)</span> leading principal minors of <span class="math notranslate nohighlight">\(H \mathcal{L}({\bf \lambda},{\bf x})\)</span> are zero or have the same sign as <span class="math notranslate nohighlight">\((-1)^K\)</span>.</p>
<p><span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> is <strong>negative definite</strong> on a linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span>
<span class="math notranslate nohighlight">\(\iff\)</span>
the last <span class="math notranslate nohighlight">\(N-K\)</span> leading principal minors of <span class="math notranslate nohighlight">\(H \mathcal{L}({\bf \lambda},{\bf x})\)</span> are non-zero and alternate in sign, with the sign of the full Hessian matrix equal to <span class="math notranslate nohighlight">\((-1)^N\)</span>.</p>
<p><span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> is <strong>positive definite</strong> on a linear constraint set <span class="math notranslate nohighlight">\(\{v: Dg({\bf x}^\star)\cdot v = {\bf 0}\}\)</span>
<span class="math notranslate nohighlight">\(\iff\)</span>
the last <span class="math notranslate nohighlight">\(N-K\)</span> leading principal minors of <span class="math notranslate nohighlight">\(H \mathcal{L}({\bf \lambda},{\bf x})\)</span> are non-zero and have the same sign as <span class="math notranslate nohighlight">\((-1)^K\)</span>.</p>
</div>
<ul class="simple">
<li><p>Similarly to the unconstrained case, when none of the listed conditions for the bordered Hessian hold, it is <em><strong>indefinite</strong></em> and the point tested by the second order conditions is not a constrained optimizer.</p></li>
</ul>
<div class="important admonition">
<p class="admonition-title">Fact</p>
<p>Determinant of <span class="math notranslate nohighlight">\(3 \times 3\)</span> matrix can be computed by the <strong>triangles rule</strong>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathrm{det}
\left(
\begin{array}{ccc}
a_{11},&amp; a_{12},&amp; a_{13} \\
a_{21},&amp; a_{22},&amp; a_{23} \\
a_{31},&amp; a_{32},&amp; a_{33}
\end{array}
\right) =
\begin{array}{l}
+ a_{11}a_{22}a_{33} \\
+ a_{12}a_{23}a_{31} \\
+ a_{13}a_{21}a_{32} \\
- a_{13}a_{22}a_{31} \\
- a_{12}a_{21}a_{33} \\
- a_{11}a_{23}a_{32}
\end{array}
\end{split}\]</div>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/det33.png"><img alt="_images/det33.png" src="_images/det33.png" style="width: 325.0px; height: 155.0px;" /></a>
</figure>
</div>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<p>Let’s check the second order conditions for the consumer choice problem.</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{L}(x_1,x_2,\lambda) = \alpha \log(x_1) + \beta \log(x_2)
- \lambda(p_1 x_1 + p_2 x_2 - m)
\]</div>
<div class="math notranslate nohighlight">
\[
\nabla_{\bf x} \mathcal{L}({\bf \lambda},{\bf x}) =
\left(\frac{\alpha}{x_1} - \lambda p_1,\;
\frac{\beta}{x_2} - \lambda p_2\right)
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x}) =
\left(
\begin{array}{cc}
-\frac{\alpha}{x_1^2},&amp; 0 \\
0,&amp; -\frac{\beta}{x_2^2}
\end{array}
\right)
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
\nabla \mathcal{L}({\bf \lambda},{\bf x}) =
\left(
x_1 p_1 + x_2 p_2 -m, \;
\frac{\alpha}{x_1} - \lambda p_1, \;
\frac{\beta}{x_2} - \lambda p_2
\right)
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
H\mathcal{L}({\bf \lambda},{\bf x}) =
\left(
\begin{array}{ccc}
0,&amp; -p_1,&amp; -p_2 \\
-p_1,&amp; -\frac{\alpha}{x_1^2},&amp; 0 \\
-p_2,&amp; 0,&amp; -\frac{\beta}{x_2^2}
\end{array}
\right)
\end{split}\]</div>
<p>Solving FOC we have as before</p>
<div class="math notranslate nohighlight">
\[
{\bf x}^\star = 
\left(
\frac{\alpha}{\alpha + \beta} \frac{m}{p_1}, \;
\frac{\beta}{\beta + \alpha} \frac{m}{p_2}
\right)
\text{ and }
\lambda^\star = \frac{\alpha+\beta}{m}
\]</div>
<p>To check the second order conditions compute the Hessian at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
H\mathcal{L}({\bf \lambda}^\star,{\bf x}^\star) =
\left(
\begin{array}{ccc}
0,&amp; -p_1,&amp; -p_2 \\
-p_1,&amp; -\frac{(\alpha+\beta)^2p_1^2}{\alpha m^2},&amp; 0 \\
-p_2,&amp; 0,&amp; -\frac{(\alpha+\beta)^2p_2^2}{\beta m^2}
\end{array}
\right)
\end{split}\]</div>
<p>Because <span class="math notranslate nohighlight">\(N=2\)</span> and <span class="math notranslate nohighlight">\(K=1\)</span> we need to check one last lead principle minor, which is the determinant of the whole <span class="math notranslate nohighlight">\(H\mathcal{L}({\bf \lambda}^\star,{\bf x}^\star)\)</span>.
Using the triangle rule for computing determinants of the <span class="math notranslate nohighlight">\(3 \times 3\)</span> matrix,
we have</p>
<div class="math notranslate nohighlight">
\[
\mathrm{det}\left(H\mathcal{L}({\bf \lambda}^\star,{\bf x}^\star)\right)=
\frac{(\alpha+\beta)^2 p_1^2 p_2^2}{\alpha m^2} +
\frac{(\alpha+\beta)^2 p_1^2 p_2^2}{\beta m^2} =
\frac{(\alpha+\beta)^3 p_1^2 p_2^2}{\alpha \beta m^2} &gt;0
\]</div>
<p>We have that the determinant of the bordered Hessian has the same sign as <span class="math notranslate nohighlight">\((-1)^N\)</span>, and the condition for sign alternation is satisified for <span class="math notranslate nohighlight">\(N-K = 1\)</span> last leading principal minors.</p>
<p>Hence, <span class="math notranslate nohighlight">\(H_{\bf x} \mathcal{L}({\bf \lambda},{\bf x})\)</span> is negative definite, implying that <span class="math notranslate nohighlight">\({\bf x}^\star\)</span> is the local constrained maximum of <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\(D\)</span>
by the sufficient second order condition.</p>
</div>
</section>
<section id="lagrangian-method-recipe">
<h3>Lagrangian method: recipe<a class="headerlink" href="#lagrangian-method-recipe" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Write down the Lagrangian function <span class="math notranslate nohighlight">\(\mathcal{L}({\bf x},{\bf \lambda})\)</span></p></li>
<li><p>Find all stationary points of <span class="math notranslate nohighlight">\(\mathcal{L}({\bf x},{\bf \lambda})\)</span> with respect to <span class="math notranslate nohighlight">\({\bf x}\)</span> and <span class="math notranslate nohighlight">\({\bf \lambda}\)</span>, i.e. solve the system of first order equations</p></li>
<li><p>Derive the bordered Hessian <span class="math notranslate nohighlight">\(H \mathcal{L}({\bf x},{\bf \lambda})\)</span> and compute it value at the stationary points</p></li>
<li><p>Using second order conditions, check if the stationary points are local optima</p></li>
<li><p>Compare the function values at all identified local optima to find the global one</p></li>
</ol>
<ul class="simple">
<li><p>in practice second order conditions (steps 3 and 4) may be skipped when for example the global shape of the function is known (convex case)</p></li>
</ul>
</section>
<section id="when-does-lagrange-method-fail">
<h3>When does Lagrange method fail?<a class="headerlink" href="#when-does-lagrange-method-fail" title="Permalink to this heading">#</a></h3>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f(x,y) = -y \to \max_{x,y}
\\
\text {subject to}
\\
g(x,y) = y^3 -x^2 = 0
\end{split}\]</div>
<p>Proceed according to the Lagrange recipe</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{L}(x,y,\lambda) = -y -\lambda(y^3 -x^2)
\]</div>
<div class="math notranslate nohighlight">
\[
\nabla \mathcal{L}(x,y,\lambda) =
\left(x^2-y^3,\; 2x\lambda,\; -3y^2\lambda-1
\right)
\]</div>
<p>The FOC system of equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
2x\lambda =0 \\
3y^2\lambda+1=0 \\
x^2-y^3 =0
\end{cases}
\end{split}\]</div>
<p>does not have solutions! From second equation <span class="math notranslate nohighlight">\(\lambda \ne 0\)</span>, then from the first equation <span class="math notranslate nohighlight">\(x=0\)</span>, and so <span class="math notranslate nohighlight">\(y=0\)</span> from the thrid, but then the second equation is not satisfied.</p>
<p>However, we can deduce that <span class="math notranslate nohighlight">\((x^\star,y^\star)=(0,0)\)</span> is a maximizer in the following way. For all points <span class="math notranslate nohighlight">\((x,y)\)</span> which satisfy the constraint <span class="math notranslate nohighlight">\(y^3 \ge 0\)</span> because <span class="math notranslate nohighlight">\(x^2 \ge 0\)</span>, and thus the maximum attainable value is <span class="math notranslate nohighlight">\(f(x,y)=0\)</span> which it takes at <span class="math notranslate nohighlight">\((0,0)\)</span>.</p>
<p><em>Why does Lagrange method fail?</em></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla g(x,y) = (2x,-3y^2)\\
\nabla g(x^\star,y^\star) = (0,0)
\end{split}\]</div>
<p>The Lagrange method fails because the constraint qualification assumption is not satisfied at <span class="math notranslate nohighlight">\((0,0)\)</span>, i.e. the rank of Jacobian matrix of the constraints (one by two in this case) is zero which is less than the number of constraints <span class="math notranslate nohighlight">\(K\)</span>.</p>
</div>
<p>Lagrange method may not work when:</p>
<ul class="simple">
<li><p>Constraints qualification assumption is not satisfied at the stationary point</p></li>
<li><p>FOC system of equations does not have solutions (thus no local optima)</p></li>
<li><p>Saddle points – second order conditions can help</p></li>
<li><p>local optimizer is not a global one – no way to check without studying analytic properties of each problem</p></li>
</ul>
<p>Conclusion: great tool, but blind application may lead to wrong results!</p>
</section>
</section>
<section id="inequality-constrains-and-kuhn-tucker-method">
<h2>Inequality constrains and Kuhn-Tucker method<a class="headerlink" href="#inequality-constrains-and-kuhn-tucker-method" title="Permalink to this heading">#</a></h2>
<p>Turning now to the inequality constrained optimization problems</p>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<p>Maximization of utility subject to budget constraint</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
u(x_1, x_2) = \alpha x_1 + \beta \log(x_2) \to \max_{x_1, x_2} \\
\text{ subject to} \\
p_1 x_1 + p_2 x_2 \leq m \\
x_1 \geq 0, \; x_2 \geq 0
\end{split}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p_i\)</span> is the price of good <span class="math notranslate nohighlight">\(i\)</span>, assumed non-negative</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> is the budget, assumed non-negative</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha&gt;0\)</span>, <span class="math notranslate nohighlight">\(\beta&gt;0\)</span></p></li>
</ul>
<p>Apply the Lagrange method neglecting the non-negativity requirement and assuming no money are wasted, and so the budget constraint binds:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathcal{L}(x_1,x_2,\lambda) = \alpha x_1 + \beta\log(x_2) - \lambda (p_1 x_1 + p_2 x_2 -m)\\
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{\partial \mathcal{L}}{\partial x_1} = 0 \implies
\alpha - \lambda p_1 = 0\\
\frac{\partial \mathcal{L}}{\partial x_2} = 0 \implies
\frac{\beta}{x_2} - \lambda p_2 = 0 \\
\frac{\partial \mathcal{L}}{\partial \lambda} = 0 \implies
x_1 p_1 + x_2 p_2 -m = 0
\end{split}\]</div>
<p>Solving FOC, from the first equation we have <span class="math notranslate nohighlight">\(\lambda = \alpha/p_1\)</span>, then from the second equation <span class="math notranslate nohighlight">\(x_2 = \beta p_1/ \alpha p_2\)</span> and from the third <span class="math notranslate nohighlight">\(x_1 = m/p_1 -\beta/\alpha\)</span>. This is the only stationary point.</p>
<p>Hence, for some admissible parameter values, for example, <span class="math notranslate nohighlight">\(\alpha=\beta=1\)</span>, <span class="math notranslate nohighlight">\(p_1=p_2=1\)</span> and <span class="math notranslate nohighlight">\(m=0.4\)</span> we can have the optimal level of consumption of good 1 to be negative!</p>
</div>
<figure class="align-default" id="id20">
<img alt="_images/corner_sol.png" src="_images/corner_sol.png" />
<figcaption>
<p><span class="caption-number">Fig. 103 </span><span class="caption-text">Tangent point is infeasible</span><a class="headerlink" href="#id20" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Interpretation: No interior solution</p>
<p>Put differently</p>
<ul class="simple">
<li><p>Every interior point on the budget line is dominated by the infeasible solution</p></li>
<li><p>Hence solution must be on the boundary</p></li>
</ul>
<p>Since <span class="math notranslate nohighlight">\(x_2 = 0\)</span> implies <span class="math notranslate nohighlight">\(x_1 + \log(x_2) = - \infty\)</span>, solution is</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_1^\star = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_2^\star = m/p_2 = 0.4\)</span></p></li>
</ul>
<figure class="align-default" id="id21">
<img alt="_images/corner_sol_2.png" src="_images/corner_sol_2.png" />
<figcaption>
<p><span class="caption-number">Fig. 104 </span><span class="caption-text">Corner solution</span><a class="headerlink" href="#id21" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Let’s look at the systematic solution approach where the corner solutions will emerge naturally when they are optimal.</p>
<div class="important admonition">
<p class="admonition-title">Karush-Kuhn-Tucker conditions</p>
<p>Let <span class="math notranslate nohighlight">\(f \colon \mathbb{R}^N \to \mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(g \colon \mathbb{R}^N \to \mathbb{R}^K\)</span> be continuously differentiable functions.</p>
<p>Let <span class="math notranslate nohighlight">\(D = U \cap \{ {\bf x} \colon g_i({\bf x}) \le 0, i=1,\dots,K \}\)</span> where <span class="math notranslate nohighlight">\(U \subset \mathbb{R}^N\)</span> is an open set.</p>
<p>Suppose that <span class="math notranslate nohighlight">\({\bf x}^\star \in D\)</span> is a local extremum of <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\(D\)</span> and that the gradients of the constraint functions <span class="math notranslate nohighlight">\(g_i\)</span> <em>corresponding to the binding constraints</em> are linearly independent at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span> (equivalently, the rank of the matrix composed of the gradients of the binding constraints is equal to the number of binding constraints).</p>
<p>Then there exists a vector <span class="math notranslate nohighlight">\(\lambda^\star \in \mathbb{R}^K\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
Df({\bf x}^\star) - \lambda^\star \cdot Dg({\bf x}^\star) =
Df({\bf x}^\star) - \sum_{i=1}^K \lambda_i^\star Dg_i({\bf x}^\star) =
{\bf 0}
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\lambda_i^\star \ge 0 \text{ with } \lambda_i^\star g_i({\bf x}^\star) =0 \; i=1,\dots,K
\]</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Proof</p>
<p>See Sundaram 6.5</p>
</div>
<ul class="simple">
<li><p>Very similar to the Lagrange theorem, but now we have inequalities!</p></li>
<li><p>The last set of conditions is called the <strong>complementary slackness</strong> conditions, and they play the following role:</p>
<ul>
<li><p>if for a given <span class="math notranslate nohighlight">\(i\)</span> <span class="math notranslate nohighlight">\(g_i({\bf x}^\star) = 0\)</span>, that is the <span class="math notranslate nohighlight">\(i\)</span>-th constraint is <strong>binding</strong> , then the corresponding <span class="math notranslate nohighlight">\(\lambda_i^\star &gt; 0\)</span> acts as a Lagrange multiplier for an equality constraint</p></li>
<li><p>if on the other hand for a given <span class="math notranslate nohighlight">\(i\)</span> <span class="math notranslate nohighlight">\(g_i({\bf x}^\star) &lt; 0\)</span>, the corresponding <span class="math notranslate nohighlight">\(\lambda_i^\star\)</span> must be zero, removing the term with <span class="math notranslate nohighlight">\(Dg_i({\bf x}^\star)\)</span> from the first condition</p></li>
</ul>
</li>
<li><p>This way the KKT conditions combine the unconstrained and equality constrained conditions in one</p></li>
</ul>
<figure class="align-default" id="id22">
<a class="reference internal image-reference" href="_images/KKTdiagram.png"><img alt="_images/KKTdiagram.png" src="_images/KKTdiagram.png" style="width: 440.0px; height: 354.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 105 </span><span class="caption-text">Binding and non-binding constraint at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span></span><a class="headerlink" href="#id22" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="karush-kuhn-tucker-method-recipe">
<h3>Karush - Kuhn-Tucker method: recipe<a class="headerlink" href="#karush-kuhn-tucker-method-recipe" title="Permalink to this heading">#</a></h3>
<p>Essentially the same as for the Lagrange method</p>
<ol class="arabic simple">
<li><p>Write down the Lagrangian function <span class="math notranslate nohighlight">\(\mathcal{L}({\bf x},{\bf \lambda})\)</span></p></li>
<li><p>Solve the KKT first order conditions to find the stationary points of
<span class="math notranslate nohighlight">\(\mathcal{L}({\bf x},{\bf \lambda})\)</span> with respect to <span class="math notranslate nohighlight">\({\bf x}\)</span>, together with the non-negativity of KKT multipliers and complimentary slackness conditions</p></li>
<li><p>Using second order conditions using the subset of binding constraints, check if the stationary points at the boundary are local optima. Similarly, using the second order conditions for the unconstrained problem to investigate the interior stationary points</p></li>
<li><p>Compare the function values at all identified local optima to find the global one</p></li>
</ol>
<p>Possible issues with KKT method are similar to the Lagrange method:</p>
<ul class="simple">
<li><p>constraint qualification assumption</p></li>
<li><p>existence of constrained optima</p></li>
<li><p>local vs global optimality</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<p>Returning to the utility maximization problem with budget constraint and non-negative consumption</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
u(x_1, x_2) = \alpha x_1 + \beta \log(x_2) \to \max_{x_1, x_2} \\
\text{ subject to} \\
p_1 x_1 + p_2 x_2 \leq m \\
x_1 \geq 0, \; x_2 \geq 0
\end{split}\]</div>
<p>Form the Lagrangian with 3 inequality constraints (have to flip the sign for non-negativity to stay within the general formulation)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathcal{L}(x_1,x_2,\lambda_1,\lambda_2,\lambda_3) = \\
= \alpha x_1 + \beta\log(x_2)  - \lambda_1 (-x_1) - \lambda_2 (-x_2) - \lambda_3 (p_1 x_1 + p_2 x_2 -m) = \\
= \alpha x_1 + \beta\log(x_2) + \lambda_1 x_1+ \lambda_2 x_2 - \lambda_3 (p_1 x_1 + p_2 x_2 -m)
\end{split}\]</div>
<p>The necessary KKT conditions are given by the following system of equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
\frac{\partial \mathcal{L}}{\partial x_1} = 0 \implies
\alpha + \lambda_1 - \lambda_3 p_1 = 0 \\
\frac{\partial \mathcal{L}}{\partial x_2} = 0 \implies
\frac{\beta}{x_2} + \lambda_2 - \lambda_3 p_2 = 0 \\
x_1 \ge 0 \\
x_2 \ge 0 \\
x_1 p_1 + x_2 p_2 \le m \\
\lambda_1 \ge 0 \text { and } \lambda_1 x_1 = 0 \\
\lambda_2 \ge 0 \text { and } \lambda_2 x_2 = 0 \\
\lambda_3 \ge 0 \text { and } \lambda_3 (x_1 p_1 + x_2 p_2 -m) = 0 \\
\end{cases}
\end{split}\]</div>
<p>The KKT conditions can be solved systematically by considering all combinations of the multipliers:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\lambda_1=\lambda_2=\lambda_3=0\)</span> <br />
The first equation becomes <span class="math notranslate nohighlight">\(\alpha = 0\)</span> which is inconsistent with the initially set <span class="math notranslate nohighlight">\(\alpha&gt;0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_1=\lambda_2=0, \; \lambda_3&gt;0 \implies x_1 p_1 + x_2 p_2 -m = 0\)</span> <br />
This is the exact case we looked at with the Lagrange method ignoring the non-negativity conditions on consumption. The solution is <span class="math notranslate nohighlight">\(x_1^\star = \frac{m}{p_1} - \frac{\beta}{\alpha}\)</span> and <span class="math notranslate nohighlight">\(x_2^\star = \frac{\beta p_1}{\alpha p_2}\)</span> if it also holds that <span class="math notranslate nohighlight">\(x_1^\star &gt;0\)</span> and <span class="math notranslate nohighlight">\(x_2^\star &gt;0\)</span>, i.e. <span class="math notranslate nohighlight">\(p_1/m &lt; \alpha/\beta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_1=\lambda_3=0, \; \lambda_2&gt;0 \implies x_2 = 0\)</span> <br />
The case of <span class="math notranslate nohighlight">\(x_2=0\)</span> is outside of the domain of the utility function and could in fact be excluded from the start.</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_1=0, \;\lambda_2&gt;0, \; \lambda_3&gt;0 \implies x_2 = x_1\)</span> and <span class="math notranslate nohighlight">\(p_1 + x_2 p_2 -m = 0\)</span> <br />
Inconsistent similarly to the previous case</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_1&gt;0, \;\lambda_2 = \lambda_3 = 0 \implies x_1 = 0\)</span> <br />
The second equation becomes <span class="math notranslate nohighlight">\(\beta / x_2 = 0\)</span> which is inconsistent with the <span class="math notranslate nohighlight">\(\beta&gt;0\)</span> and <span class="math notranslate nohighlight">\(x_2 \ne 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_1&gt;0, \;\lambda_2 = 0, \; \lambda_3 &gt; 0 \implies x_1 = 0\)</span> and <span class="math notranslate nohighlight">\(p_1 + x_2 p_2 -m = 0\)</span> <br />
We have the following system in this case</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{cases}
  \alpha + \lambda_1 - \lambda_3 p_1 = 0 \\
  \frac{\beta}{x_2} - \lambda_3 p_2 = 0 \\
  x_2 p_2 -m = 0
  \end{cases}
  \end{split}\]</div>
<p>From the last equation <span class="math notranslate nohighlight">\(x_2 = m/p_2\)</span>,
combining the two last equations <span class="math notranslate nohighlight">\(\lambda_3 = \beta/m\)</span>,
and from the first equation <span class="math notranslate nohighlight">\(\lambda_1 = \beta p_1/m - \alpha\)</span>.
The solution holds conditional on <span class="math notranslate nohighlight">\(\lambda_1&gt;0\)</span>, i.e. <span class="math notranslate nohighlight">\(p_1/m &gt; \alpha/\beta\)</span>.</p>
<ol class="arabic simple" start="7">
<li><p><span class="math notranslate nohighlight">\(\lambda_1&gt;0, \;\lambda_2 &gt; 0, \; \lambda_3 = 0 \implies x_1 = 0\)</span> and <span class="math notranslate nohighlight">\(x_2 = 0\)</span> <br />
Inconsistent similar to case 3</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_1&gt;0, \;\lambda_2 &gt; 0, \; \lambda_3 &gt; 0 \implies x_1 = x_2 = p_1 + x_2 p_2 -m = 0\)</span> <br />
Inconsistent similarly to the previous case</p></li>
</ol>
<p>To summarize, the solution to the KKT conditions is given by the following cases (it’s easy to see that the two solutions coincide for the equality in the parameter condition):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
x_1^\star = \frac{m}{p_1} - \frac{\beta}{\alpha}, \;
x_2^\star = \frac{\beta p_1}{\alpha p_2}, &amp; 
\text{ if } p_1/m \le \alpha/\beta, \\
x_1^\star = 0, \;
x_2^\star = \frac{m}{p_2}, &amp; 
\text{ if } p_1/m &gt; \alpha/\beta \\
\end{cases}
\end{split}\]</div>
<p>Thus, the corner solution is included in the solution set of the KKT conditions.</p>
</div>
</section>
<section id="id2">
<h3>Second order conditions<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>Nearly identical to the secondary order conditions in the equality constraints case, except written only for the constraints which are binding/active at <span class="math notranslate nohighlight">\({\bf x}^\star\)</span> under consideration.</p>
<div class="tip admonition">
<p class="admonition-title">Example</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f(x,y) = \frac{x^3}{3}-3y^2+5x-6xy \to \max_{x,y} \\
\text {subject to} \\
(x/4)^2 + (y/8)^2 \le 1,\\
x,y \in \mathbb{R}
\end{split}\]</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">zs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y</span><span class="p">))])</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span>
<span class="c1"># (x/a)^2 + (y/b)^2 = 1</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">zs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">X1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y1</span><span class="p">))])</span>
<span class="n">Z1</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">160</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">Y1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span><span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">160</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> 
            <span class="n">rstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
            <span class="n">cstride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">f0</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">)))</span><span class="o">+</span><span class="mf">0.1</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">Y1</span><span class="p">,</span> <span class="n">Z1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax3</span><span class="p">,</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span><span class="n">yticks</span><span class="o">=</span><span class="p">[],</span><span class="n">zticks</span><span class="o">=</span><span class="p">[])</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">154</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/c3ef60110a90d621748f7772b4ccfebc916d6acf001c5d675a9d7541f60b5259.png"><img alt="_images/c3ef60110a90d621748f7772b4ccfebc916d6acf001c5d675a9d7541f60b5259.png" class="align-center" src="_images/c3ef60110a90d621748f7772b4ccfebc916d6acf001c5d675a9d7541f60b5259.png" style="width: 80%;" /></a>
<a class="reference internal image-reference" href="_images/4bb5f7adf7cb7913ae3dd011eaa25d14cc9bcc3885ebd10b7887b54d67361de3.png"><img alt="_images/4bb5f7adf7cb7913ae3dd011eaa25d14cc9bcc3885ebd10b7887b54d67361de3.png" class="align-center" src="_images/4bb5f7adf7cb7913ae3dd011eaa25d14cc9bcc3885ebd10b7887b54d67361de3.png" style="width: 80%;" /></a>
</div>
</div>
</section>
</section>
<section id="extra-material">
<h2>Extra material<a class="headerlink" href="#extra-material" title="Permalink to this heading">#</a></h2>
<p>Story of William Karush and his contribution the KKT theorem by Richard W Cottle (<a class="reference external" href="https://www.math.uni-bielefeld.de/documenta/vol-ismp/41_cottle-richard.pdf">download pdf</a>)</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="07.unconstrained.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Unconstrained optimization</p>
      </div>
    </a>
    <a class="right-next"
       href="09.practical_session.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Guest lecture</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#announcements-reminders">Announcements &amp; Reminders</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plan-for-this-lecture">Plan for this lecture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-a-constrained-optimization-problem">Setting up a constrained optimization problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#equality-constrains-and-lagrange-method">Equality constrains and Lagrange method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Constrained Optimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#substitution-method">Substitution Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#substitution-method-recipe">Substitution method: recipe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tangency">Tangency</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-tangency-relative-slope-conditions">Using Tangency: Relative Slope Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tangency-condition-algorithm">Tangency condition algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slope-conditions-for-minimization">Slope Conditions for Minimization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-method-of-lagrange-multipliers">The method of Lagrange multipliers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrangean-as-tangency-condition">Lagrangean as tangency condition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order-conditions">Second order conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrangian-method-recipe">Lagrangian method: recipe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-does-lagrange-method-fail">When does Lagrange method fail?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inequality-constrains-and-kuhn-tucker-method">Inequality constrains and Kuhn-Tucker method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#karush-kuhn-tucker-method-recipe">Karush - Kuhn-Tucker method: recipe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Second order conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-material">Extra material</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fedor Iskhakov
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>