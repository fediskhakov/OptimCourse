---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.11.5
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---




% 
% Cover:
% - bounded sets 
% - open and closed sets
% - sup and inf for sets
% - Bolzano-Weierstrass theorem (convergent subsequence)
% - –ª–µ–º–º–∞ –æ –≤–ª–æ–∂–µ–Ω—ã—Ö –æ—Ç—Ä–µ–∑–∫–∞—Ö ??
% 
% 
% Properties of optima
% - larger domain monotonicity
% - min and max conversion
% - monotone transformations of objective
% - 
% 

# üìñ Fundamentals of optimization

<small>‚è± <span class="eta"></span> | <span class="words"></span> words</small>

> The goal is **Weierstrass extreme value theorem** which establishes the existence of max and min for continuous functions over compact sets



(ref-suprema)=
## Suprema and Infima ($\mathrm{sup}$ + $\mathrm{inf}$)

In the introductory lecture we have seen a few simple examples of optimization problems. Like in many introductory econ/finance cources
we get well behaved, prepackaged problems.

Usually they 
- have a solution
- the solution is unique and not hard to find

However, for the *majority* of problems such properties aren't guaranteed

We need some idea of how to check these things

Consider the problem of finding the "maximum" or "minimum" of a function

A first issue is that such values might not be well defined

Recall that the set of maximizers/minimizers can be 
- empty
- a singleton (contains one element)
- infinite (contains infinitely many elements)

```{code-cell} python3
:tags: [hide-cell]

from myst_nb import glue
import matplotlib.pyplot as plt
import numpy as np

def subplots():
    "Custom subplots with axes through the origin"
    fig, ax = plt.subplots()
    # Set the axes through the origin
    for spine in ['left', 'bottom']:
        ax.spines[spine].set_position('zero')
    for spine in ['right', 'top']:
        ax.spines[spine].set_color('none')
    return fig, ax

xmin, xmax = 0, 1
xgrid1 = np.linspace(xmin, xmax, 100)
xgrid2 = np.linspace(xmax, 2, 10)

fig, ax = subplots()
ax.set_ylim(0, 1.1)
ax.set_xlim(-0.0, 2)
func_string = r'$f(x) = x^2$ if $x < 1$ else $f(x) = 0.5$'
ax.plot(xgrid1, xgrid1**2, 'b-', lw=3, alpha=0.6, label=func_string)
ax.plot(xgrid2, 0 * xgrid2 + 0.5, 'b-', lw=3, alpha=0.6)
#ax.legend(frameon=False, loc='lower right', fontsize=16)
glue("fig_none", fig, display=False)

```

````{admonition} Example: no maximizers
:class: tip

The following function has no maximizers on $[0, 2]$

$$
f(x) = 
\begin{cases}
x^2 &  \text{ if } x < 1
\\
1/2 &  \text{ otherwise}
\end{cases}
$$

```{glue:figure} fig_none
:width: 80%
:align: center

No maximizer on $[0, 2]$
```
````

This leads us to start with "suprema" and "infima"

- Always well defined
- Agree with max and min when the latter exist

```{admonition} Definition
:class: caution

Let $A \subset \mathbb{R}$.
A number $u \in \mathbb{R}$ is called an **upper bound** of $A$ if 
%
$$
%
a \leq u \quad \text{for all} \quad a \in A
%
$$
%

```

```{admonition} Example
:class: tip

If $A = (0, 1)$ then 10 is an upper bound of $A$ --- indeed, every element of $(0, 1)$ is $\leq 10$

If $A = (0, 1)$ then 1 is an upper bound of $A$ --- indeed, every element of $(0, 1)$ is $\leq 1$

If $A = (0, 1)$ then $0.5$ is **not** an upper bound of $A$ ---
$a = 0.6 \in (0, 1) = A$ and $0.5 < 0.6$

```


Let $U(A) :=$ set of all upper bounds of $A$

```{figure} _static/plots/upper_bounds.png
:name: 

```

```{admonition} Examples
:class: tip

- If $A = [0, 1]$, then $U(A) = [1, \infty)$
- If $A = (0, 1)$, then $U(A) = [1, \infty)$
- If $A = (0, 1) \cup (2, 3)$, then $U(A) = [3, \infty)$
- If $A = \mathbb{N}$, then $U(A) = \emptyset$

```

```{admonition} Definition
:class: caution

The *least upper bound* of $A$ is called **supremum** of $A$.

```

In other words, if $s$ is a number satisfying
%
$$
%
s \in U(A)
\qquad \text{and} \qquad
s \leq u, \; \forall \, u \in U(A)
%
$$
% 
then $s$ is the **supremum** of $A$ and we write $s = \sup A$

```{figure} _static/plots/sup.png
:name: 

```

```{admonition} Example
:class: tip

If $A = (0, 1]$, then $U(A) = [1, \infty)$, so $\sup A = 1$
```

```{admonition} Example
:class: tip

If $A = (0, 1)$, then $U(A) = [1, \infty)$, so $\sup A = 1$
```

```{admonition} Definition
:class: caution

A set $A \subset \mathbb{R}$ is called **bounded above** if $U(A)$ is not empty

```

```{admonition} Fact
:class: important

If $A$ is nonempty and bounded above then $A$ has a supremum in $\mathbb{R}$
```

- Equivalent to the fact that all Cauchy sequences converge 

- Same principle: $\mathbb{R}$ has no "gaps" or "holes"

What if $A$ is not bounded above, so that $U(A) = \emptyset$?

We follow the convention that $\sup A := \infty$ in this case

Now the supremum of a nonempty subset of $\mathbb{R}$ **always** exists


```{note}
Aside: Conventions for dealing with symbols "$\infty$'' and ``$-\infty$"

If $a \in \mathbb{R}$, then


- $a + \infty = \infty$
- $a - \infty = -\infty$
- $a \times \infty = \infty$ if $a \ne 0$, $0 \times \infty = 0$
- $-\infty < a < \infty$
- $\infty + \infty = \infty$
- $-\infty - \infty = -\infty$

But $\infty - \infty$ is not defined
```


```{admonition} Fact
:class: important

If $A \subset B$, then $\sup A \leq \sup B$
```

```{figure} _static/plots/sup_ab.png
:name: 

```

````{admonition} Proof
:class: dropdown

Let $A \subset B$

If $\sup B = \infty$ then the claim is trivial so suppose $\bar b = \sup B < \infty$

By definition, $\bar b \in U(B)$, so $b \leq \bar b$ for all $b \in B$

Since each $a \in A$ is also in $B$, we then have $a \leq \bar b$ for all $a \in A $

It follows that $\bar b \in U(A)$

Hence $\sup A \leq \bar b$

````


```{admonition} Fact
:class: important

Let $A$ be any set bounded from above and let $s := \sup A$.
There exists a sequence $\{x_n\}$ in $A$ with $x_n \to s$.
```

````{admonition} Proof
:class: dropdown

Note that 
%
$$
%
\forall \, n \in \mathbb{N}, \;\; \exists \, x_n \in A \; \text{ such that } \; x_n > s - \frac{1}{n}
%
$$
%


```{figure} _static/plots/sup_seq.png
:name: 

```

(Otherwise $s$ is not a sup, because $s-\frac{1}{n}$ is a smaller upper bound)

The sequence $\{x_n\}$ lies in $A$ and converges to $s$
````

```{admonition} Definition
:class: caution

A **lower bound** of $A \subset \mathbb{R}$ is any $\ell \in \mathbb{R}$ with $\ell \leq a$ for all $a \in A$ 

```

```{admonition} Definition
:class: caution

If $i \in \mathbb{R}$ is an lower bound for $A$ with $i \geq \ell$ for every
lower bound $\ell$ of $A$, then $i$ is called the
**infimum** of $A$ 

```

Infimum is written as $i = \inf A$

```{admonition} Example
:class: tip

- If $A = [0, 1]$, then $\inf A = 0$
- If $A = (0, 1)$, then $\inf A = 0$

```


```{admonition} Fact
:class: important

Every nonempty subset of $\mathbb{R}$ bounded from below has an infimum
```

If $A$ is unbounded below then we set $\inf A = -\infty$

### Maxima and Minima of Sets

In optimization we're mainly interested in maximizing and minimizing functions

%
$$
%
\max_{{\bf x} \in A} f({\bf x})
%
$$
%

As we'll see, the problem is the same as finding the largest number in the **range of** $f$

That is, the largest number **in the set**
%
$$
f(A) := \{ f({\bf x}) \colon {\bf x } \in A\}
$$
%

```{admonition} Definition
:class: caution

We call $a^*$ the **maximum** of $A \subset \mathbb{R}$ and write $a^* = \max A$ if
%
$$
%
a^* \in A 
\qquad \text{and} \qquad
a \leq a^*
\text{ for all } 
a \in A 
%
$$
%

```

```{admonition} Example
:class: tip

If $A = [0, 1]$ then $\max A = 1$
```

```{admonition} Definition
:class: caution

We call $a^*$ the **minimum** of $A \subset \mathbb{R}$ and write $a^* = \min A$ if
%
$$
%
a^* \in A 
\qquad \text{and} \qquad
a^* \leq a
\text{ for all } 
a \in A 
%
$$
%

```

```{admonition} Example
:class: tip

If $A = [0, 1]$ then $\min A = 0$
```

```{admonition} Fact
:class: important

If $A \subset \mathbb{R}$ is finite then $\max A$ and $\min A$ always exist

```

```{admonition} Example
:class: tip

- $\max\{2, 4, 6, 8\} = 8$
- $\min\{2, 4, 6, 8\} = 2$

```

%Some facts about max and min for pairs:
%
%```{admonition} Fact
%:class: important
%
%For any $x, y \in \mathbb{R}$ and $a \in \mathbb{R}_+ := [0, \infty)$, we have
%
%- $x + y = x \vee y + x \wedge y$
%- $|x - y| = x \vee y - x \wedge y$
%- $|x - y| = x + y - 2 (x \wedge y)$
%- $|x - y| = 2 ( x \vee y) -x -y$
%- $a(x \vee y) = (ax ) \vee (ay)$
%- $a(x \wedge y) = (ax ) \wedge (ay)$
%
%```
%

%Let's prove that $x + y = x \vee y + x \wedge y$

%Pick any $x, y \in \mathbb{R}$

%Suppose first that $x \leq y$

%Then 
%
%
% $$x \vee y + x \wedge y = y + x$$
%

%Suppose instead that $x > y$

%Then 
% 
%
% $$x \vee y + x \wedge y = x + y$$
%

```{admonition} Fact
:class: important

For infinite subsets of $\mathbb{R}$, max and min may not exist!

```

```{admonition} Example
:class: tip

$\max \mathbb{N}$ does not exist
```

````{admonition} Proof
:class: dropdown

Suppose to the contrary that $n^* = \max \mathbb{N}$

By the definition of the maximum, $n^* \in \mathbb{N}$

Now consider 
%
$$
%
n^{**} := n^* + 1
%
$$
%

Clearly 
%
$$
%
n^{**} \in \mathbb{N}
\quad \text{and} \quad 
n^{**} > n^*
%
$$
%

This contradicts the definition of $n^*$

````

```{admonition} Example
:class: tip

$\max (0, 1)$ does not exist
```

````{admonition} Proof
:class: dropdown

Suppose to the contrary that $a^* = \max (0, 1)$

By the definition of the maximum, $a^* \in (0, 1)$

Hence $a^* < 1$


Now consider 
%
$$
%
a^{**} := (1 + a^*)/2
%
$$
%

Clearly 
%
$$
%
a^{**} \in (0, 1) \text{ and } a^{**} > a^*
%
$$
%

Contradicts hypothesis that $a^*$ is the maximum
````

### Relationship between max/min and sup/inf

When max and min exist they agree with sup and inf

```{admonition} Fact
:class: important

Let $A$ be any subset of $\mathbb{R}$
1. If $\sup A \in A$, then $\max A$ exists and $\max A = \sup A$
9. If $\inf A \in A$, then $\min A$ exists and $\min A = \inf A$
```

````{admonition} Proof
:class: dropdown

Proof of case 1: Let $a^* := \sup A$ and suppose $a^* \in A$

We want to show that $\max A = a^*$

Since $a^* \in A$, we need only show that $a \leq a^*$ for all $a \in A$

This follows from $a^* = \sup A$, which implies $a^* \in U(A)$

````

```{admonition} Fact
:class: important

If $F \subset \mathbb{R}$ is a closed and bounded, then 
$\max F$ and $\min F$ both exist

```

````{admonition} Proof
:class: dropdown

Proof for the max case:

Since $F$ is bounded, 

- $\sup F$ exists 

- $\exists$ a sequence $\{x_n\} \subset F$ with $x_n \to \sup F$

Since $F$ is closed, this implies that $\sup F \in F$

Hence $\max F$ exists and $\max F = \sup F$

````

%

%Let $A \subset \mathbb{R}^K$, let $F \colon A \to \mathbb{R}^J$ and let $K \subset A$

%Let $F(K) := \{ {\bf y} \in \mathbb{R}^J \colon {\bf y \} = F ({\bf x}) \text{ for some } {\bf x} \in A}$

%

%```{admonition} Fact
%:class: important

%If $K$ is closed and bounded and $F$ is continuous, then $F%(K)$ is
%```
%also closed and bounded

%

%\begin{figure}
%\scalebox{.4}{\includegraphics{compact_image.pdf}}
%\end{figure}

%

%

%Proof: Let $F$ and $K$ be as specified

%

%We claim every sequence in $F(K)$ has a subsequence converging
%to a point in $F(K)$

%

%Let $\{{\bf y}_n\} \subset F(K)$ 

%By definition, we can take $\{{\bf x}_n\} \subset K$ with $F({\bf x}_n) = {\bf y}_n$ for each $n$

%Since $K$ compact, $\exists$ subsequence $\{{\bf x}_{n_k}\}$ with ${\bf x}_{n_k} \to {\bf x} \in K$

%By continuity of $F$ we have $F ({\bf x}_{n_k}) \to F ({\bf x})$

%Since ${\bf x} \in K$ we have $F ({\bf x}) \in F(K)$ 

%In summary, ${\bf y}_{n_k} = F ({\bf x}_{n_k}) \to$ a point in $K$

%

## Existence of optima for functions

Now we turn to suprema and infima, maxima and minima (extrema) for functions

This is not a new concept --- it's just about extrema of sets --- but the sets are the **range** of functions

In particular
%
- The sup of a function $f$ is just the sup of its range
- The max of a function $f$ is just the max of its range

Througout we use the notation
%
$$
f(A) := \{ f({\bf x}) \colon {\bf x } \in A\}
$$
%

```{admonition} Definition
:class: caution

Let $f \colon A \to \mathbb{R}$, where $A$ is any set 

The **supremum of $f$ on $A$** is defined as
%
$$
%
\sup_{{\bf x} \in A} f({\bf x}) 
:= \sup f(A)
%
$$
%

The **infimum of $f$ on $A$** is defined as
% 
%
$$
%
\inf_{{\bf x} \in A} f({\bf x}) 
:= \inf f(A)
%
$$
%

```

```{figure} _static/plots/func_sup.png
:name: 

The supremum of $f$ on $A$
```

```{figure} _static/plots/func_inf.png
:name: 

The infimum of $f$ on $A$
```



```{admonition} Definition
:class: caution

Let $f \colon A \to \mathbb{R}$ where $A$ is any set

The **maximum** of $f$ on $A$ is defined as 
%
$$
%
\max_{{\bf x} \in A} f({\bf x}) 
:= \max f(A)
%
$$
%

The **minimum** of $f$ on $A$ is defined as 
%
$$
%
\min_{{\bf x} \in A} f({\bf x}) 
:= \min f(A)
%
$$

```

```{admonition} Definition
:class: caution

A **maximizer** of $f$ on $A$ is a point ${\bf a}^* \in A$ such that 
%
$$
%
f({\bf a}^*) = \max_{{\bf x} \in A} f({\bf x}),
%
$$
%
or equivalently 
%
$$
{\bf a}^* \in A \text{ and } f({\bf a}^*) \geq f({\bf x}) \text{ for all
} {\bf x} \in A
$$
%

```


The set of all maximizers is typically denoted by 
%
$$\mathrm{argmax}_{{\bf x} \in A}f({\bf x})$$
%

```{admonition} Definition
:class: caution

A **minimizer** of $f$ on $A$ is a point ${\bf a}^* \in A$ such that 
%
$$
%
f({\bf a}^*) = \min_{{\bf x} \in A} f({\bf x}),
%
$$
%
or equivalently 
%
$$
%
{\bf a}^* \in A \text{ and } f({\bf a}^*) \leq f({\bf x}) \text{ for all
} {\bf x} \in A
%
$$
%

```

The set of all minimizers denoted by 

%
$$\mathrm{argmin}_{{\bf x} \in A}f({\bf x})$$
%

## Weierstrass extreme value theorem

```{admonition} Fact (Weierstrass extreme value theorem)
:class: important
:name: extreme-value-theorem

If $f$ is continuous and $A$ is closed and bounded, then $f$ has both a maximizer and a minimizer in $A$.

```

````{admonition} Proof
:class: dropdown

Sketch:
- can show under the assumptions that $f(A)$ is closed and bounded
- proof uses Bolzano--Weierstrass theorem, details omitted

Sketch of the proof: 
- If $f$ is continuous and $A$ is compact, then $f(A)$ is bounded 
% (–ø–µ—Ä–≤–∞—è —Ç–µ–æ—Ä–µ–º–∞ –í–µ–π–µ—Ä—à—Ç—Ä–∞—Å—Å–∞)
- Sup and inf exist
- There is a sequence in $y$ converging to sup/inf
- There is a corresponding sequence of $x$ such that $y=f(x)$
- It may not be convergent, but is bounded (belongs to compact), therefore contains a convergent subsequence (by Bolzano-Weierstrass theorem)
- Let $c$ be the limit of a convergent subsequence
- Then $f(c)$ is the limit of the sequence $f(x_n)$, and must be the same as the limit of the sequence $y_n$ = sup/inf due to continuity
- Therefore sup/inf is attained at x=c

````

Hence the max of $f(A)$ exists, and we can write
%
$$
%
M^* := \max f(A) := \max \{ f({\bf x}) \colon {\bf x } \in A\}
%
$$
%

The point ${\bf x}^* \in A$ such that $f({\bf x}^*) = M^*$ is a maximizer

```{admonition} Example
:class: tip

Consider the problem
%
$$ 
%
\max_{c_1, c_2} \; U(c_1, c_2) := \sqrt{c_1} + \beta \sqrt{c_2} 
%
$$
%

%
$$
%
\text{ such that } \; c_2 \leq (1 + r)(w - c_1), 
\quad c_i \geq 0 \text{ for } i = 1,2
%
$$
%
where
%
- $r=$ interest rate, $w=$ wealth, $\beta=$ discount factor
- all parameters $> 0$ 
```

Let $B$ be all $(c_1, c_2)$ satisfying the constraint

**Exercise:** Show that the budget set $B$ is a closed, bounded subset of $\mathbb{R}^2$

**Exercise:** Show that $U$ is continuous on $B$

We conclude that a maximizer exists

## Properties of Optima

We now state some useful facts regarding optima

Sometimes we state properties about sups and infs rather than max and min --- this is so we don't have to keep saying "if it exsits"

But remember that if it does exist then the same properties apply: if a max exists, then it's a sup, etc.

```{admonition} Fact
:class: important

If $A \subset B$ and $f \colon B \to \mathbb{R}$, then
%
$$
%
\sup_{{\bf x} \in A} f({\bf x}) \leq \sup_{{\bf x} \in B} f({\bf x})
\qquad \text{and} \qquad
\inf_{{\bf x} \in A} f({\bf x}) \geq \inf_{{\bf x} \in B} f({\bf x})
%
$$
%
```

```{figure} _static/plots/sup_ab_func.png
:name: 

```

````{admonition} Proof
:class: dropdown

Proof, for the sup case: 

Let $A$, $B$ and $f$ be as in the statement of the fact

We already know that $C \subset D \implies \sup C \leq \sup D$

Hence it suffices to show that $f(A) \subset f(B)$, because then
%
$$
%
\sup_{{\bf x} \in A} f({\bf x}) 
:= \sup f(A)
\leq \sup f(B) 
=: \sup_{{\bf x} \in B} f({\bf x})
%
$$
%

To see that $f(A) \subset f(B)$, take any $y \in f(A)$

By definition, $\exists \, {\bf x} \in A$ such that $f({\bf x}) = y$

Since $A \subset B$ we must have ${\bf x} \in B$ 

So $f({\bf x}) = y$ for some ${\bf x} \in B$, and hence $y \in f(B)$

Thus $f(A) \subset f(B)$ as was to be shown

````

```{admonition} Example
:class: tip

"If you have more choice then you're better off"
```

Consider the problem of maximizing utility
%
$$
%
U(x_1, x_2) = \alpha \log(x_1) + \beta \log(x_2)
%
$$
%
over all $(x_1, x_2)$ in the budget set
%
$$
%
B(m) 
:= \left\{ 
(x_1, x_2) \in \mathbb{R}^2
\;:\;
x_i > 0 \text{ and } p_1 x_1 + p_2 x_2 \leq m
\right\}
%
$$
%
Thus, we solve
%
$$
%
\max_{{\bf x} \in B(m)} U({\bf x})
%
$$
%

Clearly $m \leq m' \implies B(m) \subset B(m')$

Hence the maximal value goes up as $m$ increases

```{figure} _static/plots/bset1.png
:name: 

Budget set $B(m)$
```

```{figure} _static/plots/bset2.png
:name: 

Budget set $B(m')$
```

```{admonition} Example
:class: tip

Let $y_n$ be income and $x_n$ be years education
```

Consider regressing income on education:
%
$$
%
y_n = \alpha + \beta x_n + \epsilon_n 
%
$$
%

We have data for $n = 1, \ldots, N$ individuals

Successful regression is often associated with large $R^2$ 

- A measure of "goodness of fit"

Large $R^2$ occurs when we have a small sum of squared residuals
%
$$
%
{\rm ssr}_a := 
\min_{\alpha, \beta} 
\; \sum_{n=1}^N \, (y_n - \alpha - \beta x_n)^2
%
$$
%

However, we can always reduce the ssr by including irrelevant variables

- e.g., $z_n = $ consumption of apples in kgs per annum
%
$$
%
{\rm ssr}_b := 
\min_{\alpha, \beta, \gamma} 
\; \sum_{n=1}^N \, (y_n - \alpha - \beta x_n - \gamma z_n)^2
\, \leq {\rm ssr}_a
%
$$
%

Indeed, let 
%
$$
%
{\boldsymbol \theta} 
:= (\alpha, \beta, \gamma),
\qquad
f({\boldsymbol \theta}) 
:= 
\sum_{n=1}^N \, (y_n - \alpha - \beta x_n - \gamma z_n)^2
%
$$
%
Then 
%
$$
%
{\rm ssr}_b 
= \min_{{\boldsymbol \theta} \in \mathbb{R}^3} f({\boldsymbol \theta})
\leq 
\min_{\substack{{\boldsymbol \theta} \in \mathbb{R}^3 \\ \gamma = 0}} f({\boldsymbol \theta})
= {\rm ssr}_a
%
$$
%

```{admonition} Fact
:class: important

If $f \colon A \to \mathbb{R}$, then 
%
$$
%
{\bf a}^* \in \mathrm{argmax}_{{\bf x} \in A}f({\bf x})
\; \iff \;
{\bf a}^* \in \mathrm{argmin}_{{\bf x} \in A} -f({\bf x})
%
$$
%
```

```{figure} _static/plots/max_min.png
:name: 

```

````{admonition} Proof
:class: dropdown

Let's prove that, when $g = -f$,
%
$$
%
{\bf a}^* \in \mathrm{argmax}_{{\bf x} \in A}f({\bf x})
\; \implies \;
{\bf a}^* \in \mathrm{argmin}_{{\bf x} \in A}g({\bf x})
%
$$
%

To begin, let ${\bf a}^*$ be a maximizer of $f$ on $A$

Then, for any given ${\bf x} \in A$ we have $f({\bf a}^*) \geq f({\bf x})$

%
$$
%
\implies
-f({\bf a}^*) \leq -f({\bf x})
%
$$
%

%
$$
%
\implies
g({\bf a}^*) \leq g({\bf x})
%
$$
%

Hence ${\bf a}^*$ is a minimizer of $g$ on $A$

- because the last inequality was shown for any ${\bf x} \in A$

````

```{admonition} Example
:class: tip

Most numerical routines provide minimization only

Suppose we want to maximize $f(x) = 3 \ln x - x$ on $(0, \infty)$

We can do this by finding the minimizer of $-f$
```

```{code-cell} python3

from scipy.optimize import fminbound
import numpy as np

f = lambda x: 3 * np.log(x) - x
g = lambda x: -f(x) # Find min of -f
print('Maximizer of f(x) on [1,100] is x=', fminbound(g, 1, 100))
```

```{admonition} Fact
:class: important

Given $A \subset \mathbb{R}^K$, let 
%
- $f \colon A \to B \subset \mathbb{R}$ 
- $h \colon B \to \mathbb{R}$ and $g := h \circ f$ 

If $h$ is strictly increasing, then 
%
$$\mathrm{argmax}_{{\bf x} \in A}f({\bf x}) =\mathrm{argmax}_{{\bf x} \in A}g({\bf x})$$
%
```

````{admonition} Proof
:class: dropdown

Let ${\bf a}^* \in \mathrm{argmax}_{{\bf x} \in A}f({\bf x})$ 

If ${\bf x} \in A$, then $f({\bf x}) \leq f({\bf a}^*)$, and hence $h(f({\bf x})) \leq h(f({\bf a}^*)) \quad$ 

In other words, $g({\bf x}) \leq g({\bf a}^*)$ for any ${\bf x} \in A$

Hence ${\bf a}^* \in \mathrm{argmax}_{{\bf x} \in A} g({\bf x})$ as claimed

````

```{figure} _static/plots/max_preserved.png
:name: 

Increasing transform $h(x) = \exp(x/2)$ preserves the maximizer
```

```{admonition} Example
:class: tip



A well known statistical problem is to maximize the likelihood of exponential distribution:
%
$$
%
\max_{\lambda > 0} L(\lambda)
\quad \text{where} \quad
L(\lambda) 
:= \lambda^N \exp \left(-\lambda \sum_{n=1}^N x_n \right)
%
$$
%

It's easier to maximize the log-likelihood function
%
$$
%
\ell(\lambda) 
:= \log(L(\lambda))
= N \log(\lambda) - \lambda \sum_{n=1}^N x_n 
%
$$
%

The unique solution
%
$$
%
\hat \lambda := \frac{N}{\sum_{n=1}^N x_n}
%
$$
%

is also the unique maximiser of $L(\lambda)$
```


In the next several propositions
%
- $A$ is any set

- $f$ is some function from $A$ to $\mathbb{R}$

- $g$ is some function from $A$ to $\mathbb{R}$

To simplify notation, we define

%
$$
%
\inf f 
:= \inf_{{\bf x} \in A} f({\bf x}) 
%
$$
%

and

%
$$
%
\sup f 
:= \sup_{{\bf x} \in A} f({\bf x}) 
%
$$
%

```{admonition} Fact
:class: important

%
$$
%
f({\bf x}) \leq g({\bf x}) \text{ for all } {\bf x} \in A
\implies
\sup f \leq \sup g
%
$$
%
```

````{admonition} Proof
:class: dropdown

Fix any such functions $f$ and $g$ and any ${\bf x} \in A$ 

We have 
% 
%
$$
%
f({\bf x}) \leq g({\bf x}) \leq \sup g
%
$$
%

Hence $\sup g$ is an upper bound for $\{ f({\bf x}) \colon {\bf x } \in A\}$

Since the supremum is the least upper bound, this gives

%
$$
%
\sup f \leq \sup g
%
$$
%

````

```{admonition} Fact
:class: important

%
$$
%
\sup_{{\bf x} \in A} (f({\bf x}) + g({\bf x})) 
\leq \sup_{{\bf x} \in A} f({\bf x}) + \sup_{{\bf x} \in A} g({\bf x})
%
$$
%
```

````{admonition} Proof
:class: dropdown

Fix any such functions $f$ and $g$ and any ${\bf x} \in A$ 

We have 
% 
%
$$
%
f({\bf x}) \leq \sup f
\quad \text{and} \quad 
g({\bf x}) \leq \sup g
%
$$
% 

%
$$
%
\implies
f({\bf x}) + g({\bf x}) \leq \sup f + \sup g
%
$$
% 

%
$$
%
\implies
\sup (f + g) \leq \sup f + \sup g
%
$$
%

````

```{admonition} Fact
:class: important
%
$$
%
| \sup_{{\bf x} \in A} f({\bf x}) - \sup_{{\bf x} \in A} g({\bf x}) | \leq
\sup_{{\bf x} \in A} |f({\bf x}) - g({\bf x})|
%
$$
%

```

````{admonition} Proof
:class: dropdown

Picking any such $f, g$, we have
%
$$
%
\sup f = \sup (f - g + g) 
\leq \sup (f - g) + \sup g
\\
\leq \sup | f - g | + \sup g
%
$$
%
$$
%
\text{therefore } \; \sup f - \sup g \leq \sup | f - g |
%
$$
%

Same argument reversing roles of $f$ and $g$ finishes the proof

````


## References and further reading

```{dropdown} References
- Simon & Blume: 12.2, 12.3, 12.4, 12.5, 13.4, 29.2, 30.1
- Sundaram: 1.2.6, 1.2.7, 1.2.8, 1.2.9, 1.2.10, 1.4.1, section 3
```
