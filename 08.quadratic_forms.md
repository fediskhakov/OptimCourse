---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---


NOTES:

determinants?

Linear algebra II: quadratic forms, positive definiteness
Ð¡Ð¼. ÐºÐ¾ÑÐ¿ÐµÐºÑ‚ II Ð¸ III
ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ, ÑÐ¸Ð¼Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡Ð½Ð°Ñ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ð°
ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ -- ÑÑƒÐ¼Ð¼Ð° ÐºÐ²Ð°Ð´Ñ€Ð°Ñ‚Ð¾Ð²
ÐšÑ€Ð¸Ð²Ñ‹Ðµ Ð¸ Ð¿Ð¾Ð²ÐµÑ€Ñ…Ð½Ð¾ÑÑ‚Ð¸
Definitness and semi-definiteness

# ðŸ“– Quadratic forms




Up till now we have studied linear functions extensively

Next level of complexity is quadratic maps

```{admonition} Definition
:class: caution

Let ${\bf A}$ be $N \times N$ and symmetric, and let ${\bf x}$ be $N \times 1$

The ***quadratic function*** on $\mathbb{R}^N$ associated with ${\bf A}$ is the map 
%
$$
%
Q \colon \mathbb{R}^N \to \mathbb{R}, \qquad
Q({\bf x}) := {\bf x}' {\bf A} {\bf x} = \sum_{j=1}^N \sum_{i=1}^N a_{ij} x_i x_j
%
$$
%

```

The properties of $Q$ depend on ${\bf A}$

An $N \times N$ symmetric matrix ${\bf A}$ is called

1. ***nonnegative definite*** if ${\bf x}' {\bf A} {\bf x} \geq 0$
for all ${\bf x} \in \mathbb{R}^N$ 

- ***positive definite*** if ${\bf x}' {\bf A} {\bf x} > 0$ for all ${\bf x}
\in \mathbb{R}^N$ with ${\bf x} \ne {\bf 0}$

- ***nonpositive definite*** if ${\bf x}' {\bf A} {\bf x} \leq 0$
for all ${\bf x} \in \mathbb{R}^N$

- ***negative definite*** if ${\bf x}' {\bf A} {\bf x} < 0$ for all ${\bf x}
\in \mathbb{R}^N$ with ${\bf x} \ne {\bf 0}$

%

```{figure} _static/plots/qform_pd.png
:name: f:qform_pd

A positive definite case: $Q({\bf x}) = {\bf x}' {\bf I} {\bf x}$ 
```

```{figure} _static/plots/qform_nd.png
:name: f:qform_nd

A negative definite case: $Q({\bf x}) =
{\bf x}'(-{\bf I}){\bf x}$ 
```

Note that some matrices have none of these properties

- ${\bf x}' {\bf A} {\bf x} < 0$ for some ${\bf x}$

- ${\bf x}' {\bf A} {\bf x} > 0$ for other ${\bf x}$

In this case ${\bf A}$ is called ***indefinite***

```{figure} _static/plots/qform_indef.png
:name: f:qform_indef

Indefinite quadratic function $Q({\bf x}) = x_1^2/2 +
8 x_1 x_2 + x_2^2/2$ 
```

```{admonition} Fact
:class: important

A symmetric matrix ${\bf A}$ is 
%
1. positive definite $\iff$ all eigenvalues are strictly positive

2. negative definite $\iff$ all eigenvalues are strictly negative

3. nonpositive definite $\iff$ all eigenvalues are nonpositive

4. nonnegative definite $\iff$ all eigenvalues are nonnegative
%
```

It follows that 
%
- ${\bf A}$ is positive definite $\implies$ $\det({\bf A}) > 0$ 

In particular, ${\bf A}$ is nonsingular



## Concavity and uniqueness of optima

Uniqueness of optima is directly connected to convexity / concavity

- Convexity is a shape property for sets

- Convexity and concavity are shape properties for functions

However, only one fundamental concept: convex sets

### Convex Sets

```{admonition} Definition
:class: caution
:name: convex-set

A set $C \subset \mathbb{R}^K$ is called ***convex*** if
%
$$
%
{\bf x}, {\bf y} \text{ in } C \text{ and } 0 \leq \lambda \leq 1
\; \implies \;
\lambda {\bf x} + (1 - \lambda) {\bf y} \in C
%
$$

```

Remark: This is vector addition and scalar multiplication

Convexity $\iff$ line between any two points in $C$ lies in $C$

```{figure} _static/plots/convex.png
:scale: 50%

```

A non-convex set

```{figure} _static/plots/non_convex.png
:scale: 50%

```

```{admonition} Example
:class: tip

The "positive cone" $P := \{ {\bf x} \in \mathbb{R}^K \colon {\bf x } \geq {\bf 0} \}$ is convex

```

````{admonition} Proof
:class: dropdown

To see this, pick any ${\bf x}$, ${\bf y}$ in $P$ and any $\lambda \in [0, 1]$

Let ${\bf z} := \lambda {\bf x} + (1 - \lambda) {\bf y}$ and let $z_k :=
{\bf e}_k' {\bf z}$

Since 
%
- $z_k = \lambda x_k + (1 - \lambda) y_k$
- $x_k \geq 0$ and $y_k \geq 0$

It is clear that $z_k \geq 0$ for all $k$

Hence ${\bf z} \in P$ as claimed

````

```{admonition} Example
:class: tip

Every $\epsilon$-ball in $\mathbb{R}^K$ is convex.
```

````{admonition} Proof
:class: dropdown

Fix ${\bf a} \in \mathbb{R}^K$, $\epsilon > 0$ and let
$B_\epsilon({\bf a})$ be the $\epsilon$-ball

Pick any ${\bf x}$, ${\bf y}$ in $B_\epsilon({\bf a})$ and any $\lambda \in [0, 1]$

The point $\lambda {\bf x} + (1 - \lambda) {\bf y}$ lies in
$B_\epsilon({\bf a})$ because
%
$$
%
\| \lambda {\bf x} + (1 - \lambda) {\bf y} - {\bf a} \|
= \| \lambda {\bf x} - \lambda {\bf a} 
+ (1 - \lambda) {\bf y} - (1 - \lambda) {\bf a} \| \leq
\\
\leq \| \lambda {\bf x} - \lambda {\bf a} \|
+ \| (1 - \lambda) {\bf y} - (1 - \lambda) {\bf a} \| =
\\
= \lambda \| {\bf x} - {\bf a} \|
+ (1 - \lambda) \| {\bf y} - {\bf a} \| <>
\\
< \lambda \epsilon + (1 - \lambda) \epsilon =
\\
= \epsilon
%
$$
%

````

```{admonition} Example
:class: tip

Let ${\bf p} \in \mathbb{R}^K$ and let $M$ be the "half-space"

%
$$
%
M := \{ {\bf x} \in \mathbb{R}^K \colon {\bf p }' {\bf x} \leq m\}
%
$$
%

The set $M$ is convex
```

````{admonition} Proof
:class: dropdown

Let ${\bf p}$, $m$ and $M$ be as described

Fix ${\bf x}$, ${\bf y}$ in $M$ and $\lambda \in [0, 1]$ 

Then $\lambda {\bf x} + (1 - \lambda) {\bf y} \in M$ because
%
$$
%
{\bf p}'[\lambda {\bf x} + (1 - \lambda) {\bf y} ] =
\lambda {\bf p}'{\bf x} + (1 - \lambda) {\bf p}'{\bf y} 
\leq \lambda m + (1 - \lambda) m
= m
%
$$
%

Hence $M$ is convex
````


```{admonition} Fact
:class: important

If $A$ and $B$ are convex, then so is $A \cap B$
```

````{admonition} Proof
:class: dropdown

Let $A$ and $B$ be convex and let $C := A \cap B$

Pick any ${\bf x}$, ${\bf y}$ in $C$ and any $\lambda \in [0, 1]$

Set 
%
$${\bf z} := \lambda {\bf x} + (1 - \lambda) {\bf y}$$
%

Since ${\bf x}$ and ${\bf y}$ lie in $A$ and $A$ is convex we have ${\bf z}
\in A$

Since ${\bf x}$ and ${\bf y}$ lie in $B$ and $B$ is convex we have ${\bf z}
\in B$

Hence ${\bf z} \in A \cap B$

````

```{admonition} Example
:class: tip

Let ${\bf p} \in \mathbb{R}^K$ be a vector of prices and consider the budget set
%
$$
%
B(m) := \{ {\bf x} \in \mathbb{R}^K \colon {\bf x } \geq {\bf 0} \text{ and }
{\bf p}' {\bf x} \leq m\}
%
$$
%

The budget set $B(m)$ is convex
```

````{admonition} Proof
:class: dropdown

To see this, note that $B(m) = P \cap M$ where
%
$$
%
P := \{ {\bf x} \in \mathbb{R}^K \colon {\bf x } \geq {\bf 0} \}
\qquad
M := \{ {\bf x} \in \mathbb{R}^K \colon {\bf p }' {\bf x} \leq m\}
%
$$
%

We already know that
%
- $P$ and $M$ are convex, intersections of convex sets are convex

Hence $B(m)$ is convex

````

### Convex Functions

Let $A \subset \mathbb{R}^K$ be a convex set and let $f$ be a function from $A$ to $\mathbb{R}$

```{admonition} Definition
:class: caution
:name: convex-function

$f$ is called ***convex*** if 
%
$$
%
f(\lambda {\bf x} + (1 - \lambda) {\bf y})
\leq \lambda f({\bf x}) + (1 - \lambda) f({\bf y})
%
$$
%
for all ${\bf x}, {\bf y} \in A$ and all $\lambda \in [0, 1]$

```

```{admonition} Definition
:class: caution

$f$ is called ***strictly convex*** if 
%
$$
%
f(\lambda {\bf x} + (1 - \lambda) {\bf y})
< \lambda f({\bf x}) + (1 - \lambda) f({\bf y})
%
$$
%
for all ${\bf x}, {\bf y} \in A$ with ${\bf x} \ne {\bf y}$ and all $\lambda \in (0, 1)$

```

```{figure} _static/plots/convex_function.png
:name: 

A strictly convex function on a subset of $\mathbb{R}$
```

```{admonition} Fact
:class: important

$f \colon A \to \mathbb{R}$ is convex if and only if its ***epigraph*** (aka supergraph)
%
$$
%
E_f := \{ ({\bf x}, y) \in A \times \mathbb{R} \colon f({\bf x \}) \leq y}
%
$$
%
is a convex subset of $\mathbb{R}^K \times \mathbb{R}$
```

```{figure} _static/plots/epigraph.png
:name: 

```

```{figure} _static/plots/qform_pd.png
:name: 

A strictly convex function on a subset of $\mathbb{R}^2$
```

```{admonition} Example
:class: tip

$f({\bf x}) = \|{\bf x}\|$ is convex on $\mathbb{R}^K$ 
```

````{admonition} Proof
:class: dropdown

To see this recall that, by the properties of norms,
%
$$
%
\|\lambda {\bf x} + (1 - \lambda) {\bf y}\|
\leq \|\lambda {\bf x}\| + \|(1 - \lambda) {\bf y}\|
\\
= \lambda \|{\bf x}\| + (1 - \lambda) \|{\bf y}\|
%
$$
%
That is,
%
$$
%
f(\lambda {\bf x} + (1 - \lambda) {\bf y})
\leq 
\lambda f({\bf x}) + (1 - \lambda) f({\bf y})
%
$$
%

````

```{admonition} Example
:class: tip

$f(x) = \cos(x)$ is ***not*** convex on $\mathbb{R}$ because

%
$$
%
1 = f(2\pi) = f(\pi/2 + 3\pi/2) > f(\pi)/2 + f(3\pi)/2 = -1
%
$$
%
```

```{admonition} Fact
:class: important

If ${\bf A}$ is $K \times K$ and positive definite, then 
%
$$
%
Q({\bf x}) = {\bf x}' {\bf A} {\bf x}
\qquad ({\bf x} \in \mathbb{R}^K)
%
$$
%
is strictly convex on $\mathbb{R}^K$
```

````{admonition} Proof
:class: dropdown

Proof: Fix ${\bf x}, {\bf y} \in \mathbb{R}^K$ with ${\bf x} \ne {\bf y}$ and $\lambda \in (0, 1)$

**Exercise:** Show that 
%
$$
%
\lambda Q({\bf x}) + (1 - \lambda) Q({\bf y})
- Q(\lambda {\bf x} + (1 - \lambda) {\bf y})
\\
= \lambda (1 - \lambda) ({\bf x} - {\bf y})' {\bf A} ({\bf x} - {\bf y})
%
$$
%

Since ${\bf x} - {\bf y} \ne {\bf 0}$ and $0 < \lambda < 1$, the right
hand side is $> 0$

Hence
%
$$
%
\lambda Q({\bf x}) + (1 - \lambda) Q({\bf y})
> Q(\lambda {\bf x} + (1 - \lambda) {\bf y})
%
$$
%
````


### Concave Functions

Let $A \subset \mathbb{R}^K$ be a convex and let $f$ be a function from $A$ to $\mathbb{R}$

```{admonition} Definition
:class: caution

$f$ is called ***concave*** if 
%
$$
%
f(\lambda {\bf x} + (1 - \lambda) {\bf y})
\geq \lambda f({\bf x}) + (1 - \lambda) f({\bf y})
%
$$
%
for all ${\bf x}, {\bf y} \in A$ and all $\lambda \in [0, 1]$

```

```{admonition} Definition
:class: caution

$f$ is called ***strictly concave*** if 
%
$$
%
f(\lambda {\bf x} + (1 - \lambda) {\bf y})
> \lambda f({\bf x}) + (1 - \lambda) f({\bf y})
%
$$
%
for all ${\bf x}, {\bf y} \in A$ with ${\bf x} \ne {\bf y}$ and all $\lambda \in (0, 1)$

```

**Exercise:** Show that 
%
1. $f$ is concave if and only if $-f$ is convex

9. $f$ is strictly concave if and only if $-f$ is strictly convex

```{admonition} Fact
:class: important

$f \colon A \to \mathbb{R}$ is concave if and only if its ***hypograph*** (aka subgraph)
%
$$
%
H_f := \{ ({\bf x}, y) \in A \times \mathbb{R} \colon f({\bf x \}) \geq y}
%
$$
%
is a convex subset of $\mathbb{R}^K \times \mathbb{R}$
```

```{figure} _static/plots/hypograph.png
:name: 

```

### Preservation of Shape

Let $A \subset \mathbb{R}^K$ be convex and let $f$ and $g$ be functions from $A$
to $\mathbb{R}$

```{admonition} Fact
:class: important

If $f$ and $g$ are convex (resp., concave) and $\alpha \geq 0$, then
%
- $\alpha f$ is convex (resp., concave)
- $f + g$ is convex (resp., concave)
```

```{admonition} Fact
:class: important

If $f$ and $g$ are strictly convex (resp., strictly concave) and $\alpha > 0$, then
%
- $\alpha f$ is strictly convex (resp., strictly concave)
- $f + g$ is strictly convex (resp., strictly concave)
```

Let's prove that $f$ and $g$ convex $\implies h := f + g$ convex

Pick any ${\bf x}, {\bf y} \in A$ and $\lambda \in [0, 1]$

We have
%
$$
%
& 
h(\lambda {\bf x} + (1 - \lambda) {\bf y})
= f(\lambda {\bf x} + (1 - \lambda) {\bf y})
+ g(\lambda {\bf x} + (1 - \lambda) {\bf y})
\\ &
\leq 
\lambda f({\bf x}) + (1 - \lambda) f({\bf y})
+
\lambda g({\bf x}) + (1 - \lambda) g({\bf y})
\\ &
=
\lambda [f({\bf x}) + g({\bf x})]
+ (1 - \lambda) [f({\bf y}) + g({\bf y})]
\\ &
=
\lambda h({\bf x}) + (1 - \lambda) h({\bf y})
%
$$
%

Hence $h$ is convex


## Uniqueness of Optimizers

```{admonition} Fact
:class: important
:name: general-uniqueness

Let $A \subset \mathbb{R}^K$ be convex and let $f \colon A \to \mathbb{R}$

1. If $f$ is strictly convex, then $f$ has at most one minimizer on $A$

9. If $f$ is strictly concave, then $f$ has at most one maximizer on $A$

```


Interpretation, strictly concave case:

- we don't know in general if $f$ has a maximizer

- but if it does, then it has exactly one

- in other words, we have uniqueness

````{admonition} Proof
:class: dropdown

Proof for the case where $f$ is strictly concave:

Suppose to the contrary that 
%
- ${\bf a}$ and ${\bf b}$ are distinct points in $A$

- both are maximizers of $f$ on $A$

By the def of maximizers, $f({\bf a}) \geq f({\bf b})$ and $f({\bf b}) \geq f({\bf a})$

Hence we have $f({\bf a}) = f({\bf b})$

By strict concavity, then
%
$$
%
f\left( \frac{1}{2} {\bf a} + \frac{1}{2} {\bf b} \right)
> \frac{1}{2} f( {\bf a}) + \frac{1}{2} f( {\bf b})
= \frac{1}{2} f( {\bf a}) + \frac{1}{2} f( {\bf a})
= f({\bf a})
%
$$
%

This contradicts the assumption that ${\bf a}$ is a maximizer

````

### A Sufficient Condition

We can now restate more precisely optimization results stated in the
introductory lectures

Let $f \colon A \to \mathbb{R}$ be a $C^2$ function where $A \subset \mathbb{R}^K$
is open, convex

Recall that ${\bf x}^* \in A$ is a stationary point of $f$ if
%
$$
%
\frac{\partial}{\partial x_i} 
f({\bf x}^*)
= 0
\quad \text{for all $i$ in } 1, \ldots, K
%
$$
%

```{admonition} Fact
:class: important
:name: general-stationary-uniqueness

If $f$ and $A$ are as above and ${\bf x}^* \in A$ is stationary, then
%
1. $f$ strictly concave $\implies$ ${\bf x}^*$ is the unique maximizer of $f$ on $A$

2. $f$ strictly convex $\implies$ ${\bf x}^*$ is the unique
minimizer of $f$ on $A$
```

%

```{figure} _static/plots/concave_max.png
:name: 

```
